{
    "_algo": [
      "async function _algo(retries = 0) {\n    let headers = {\n        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',\n        \"User-Agent\": \"Mozilla/5.0 (iPhone; CPU iPhone OS 14_5_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1 Mobile/15E148 Safari/604.1\",\n        'Cookie': this.isTxzjAct ? this.cookie\n            : \"pt_key=AAJjTLJMADBWEqzvHb5nGrz1wdG6JbtoJQLyH6mpJr3gewZEo0gxnbrW7gHn0r_-0tG4oRM8PO0;pt_pin=jd_578f2e5ca172b;\"\n    };\n    if (/(lzkj-isv)/.test(this.domain)) {\n        await this.api(`wxCommonInfo/token?t=${Date.now()}`, ``)\n    }else {\n        await this.api(this.activityUrl, \"\", {headers})\n    }\n}",
      "async function _algo(retries = 0) {\n    await this.api(this.activityUrl)\n}"
    ],
    "api": [
      "async function api(fn, param = \"\", config = {}, count = 0) {\n    await this.preHandle(fn, param, count);\n    const domain = this.match(/https?:\\/\\/([^/]+)/, fn) || this.domain\n    const protocol = this.match(/(https?):\\/\\/[^/]+/, fn) || this.protocol\n    let _u = fn, _c = {\n        headers: {\n            \"Host\": domain,\n            \"Accept\": \"application/json, text/plain, text/javascript, */*\",\n            \"Content-Type\": typeof param == \"object\" ? \"application/json;charset=utf-8\"\n                : \"application/x-www-form-urlencoded;charset=utf-8\",\n            \"Connection\": \"keep-alive\",\n            'Accept-Encoding': 'gzip, deflate, br',\n            \"Accept-Language\": \"zh-CN,zh-Hans;q=0.9\",\n            \"Origin\": this.origin || `${protocol}://${domain}`,\n            \"Referer\": this.referer || `${protocol}://${domain}/`,\n            \"User-Agent\": this.UA,\n            \"Cookie\": this.cookie\n        }\n    }, _b = param\n\n    await this.getProxy(config, _c);\n    this.requestConfig(config, _c);\n    if (!/isvjcloud/.test(domain)) {\n        let searchParams = {}\n        if (config['h5st']) {\n            _c.headers[\"Content-Type\"] = \"application/x-www-form-urlencoded;charset=utf-8\"\n            const h5st = (await this['getH5st'](param, _c.headers.Referer)).params;\n            if (config['x-api-eid-token']) {\n                const {token} = await this.getJsToken()\n                searchParams['x-api-eid-token'] = token\n            }\n            if (config['uuid']) {\n                searchParams['uuid'] = config.uuid\n            }\n            if (config.h5st === '?') {\n                _u = `${_u}?${h5st}&${this.obj2QueryString(searchParams)}`\n                _b = \"\"\n            } else {\n                _b = `${h5st}&${this.obj2QueryString(searchParams)}`\n            }\n        }\n    }\n    const __ret = await this.postHandle(fn, _u, protocol, domain, _c, _b, param);\n    _u = __ret._u;\n    _b = __ret._b;\n    try {\n        const {data, headers} = await this.request(_u, _b, _c);\n        if (!data || ['text/html;charset=UTF-8', 'text/html;charset=utf-8'].includes(headers['content-type'])) {\n            if (typeof data !== \"object\") {\n                return data;\n            }\n        }\n        if (this.isV2Act) {\n            if (data?.code === 200) {\n                data.data = this.decrypt('AES', 'CBC', 'Pkcs7', data.data, this.v2Key, this.v2Iv);\n            }\n        }\n        if (!disableLogUrlRegx.test(fn)) {\n            this.log(`ã€${fn.split(\"?\")[0]}ã€‘ ${JSON.stringify(data)}`)\n        }\n        let errorMessage = data.errorMessage || data.resp_msg || data.message || data.msg || data.data?.msg || data?.data?.levelError\n            || data?.data?.birthdayError || \"\"\n        if (errorMessage && errorMessage !== \"æˆåŠŸ\" && !successMessageRegx.test(errorMessage) && this.hasChinese(errorMessage)) {\n            const exit = this.match(exitKeywordRegx, errorMessage);\n            if (exit) {\n                throw new CustomError(errorMessage)\n            }\n            if (this.isHdbAct && /(è¯·æ±‚çš„æ•°å­—ç­¾åä¸åŒ¹é…|è¯·æ±‚çš„æ•°å­—ç­¾åå·²å¤±æ•ˆ|å½“å‰ç”¨æˆ·æœªç™»å½•)/.test(errorMessage)) {\n                await this.login()\n                return await this.api(fn, param, config, ++count);\n            }\n            if (/(æ‚¨ç‚¹çš„å¤ªå¿«äº†)/.test(errorMessage)) {\n                await this.wait(5000, 6000)\n                return await this.api(fn, param, config, ++count);\n            }\n            if (this.isJinggengjcqAct && /(è¯·ç¨åé‡è¯•)/.test(errorMessage)) {\n                await this.wait(5000, 6000)\n                return await this.api(fn, param, config, ++count);\n            }\n            if (/(åº—é“ºä¼šå‘˜|åº—é“ºå¼€å¡å|å°šæœªå¼€å¡|è¯·å…ˆå¼€å¡å…¥ä¼šåå‚ä¸æ´»åŠ¨)/.test(errorMessage)) {\n                if (notOpenCardFilenameRegx.test(this.filename)) {\n                    throw new CustomError(\"éä¼šå‘˜é€€å‡ºç¨‹åº\")\n                } else {\n                    await this.openCard();\n                    return await this.api(fn, param, config, ++count);\n                }\n            }\n            if (/(è¯·å…³æ³¨åå†æ¥å‚ä¸æ´»åŠ¨å§|æœªå…³æ³¨åº—é“º)/.test(errorMessage)) {\n                if (this.isCommonAct) {\n                    await this.api(\"wxActionCommon/newFollowShop\",\n                        `venderId=${this.venderId}&buyerPin=${this.Pin}&activityType=${this.activityType}&activityId=${this.activityId}`);\n                    await this.wait(1000, 2000)\n                    return await this.api(fn, param, config, ++count);\n                }\n                if (this.isV1Act) {\n                    await this.api('/api/task/followShop/follow', {});\n                    await this.wait(1000, 2000)\n                    return await this.api(fn, param, config, ++count);\n                }\n                if (this.isV2Act) {\n                    await this.api(`/api/common/followShop`, {});\n                    await this.wait(1000, 2000)\n                    return await this.api(fn, param, config, ++count);\n                }\n            }\n            if (/(å…ˆå…³æ³¨,å†æŠ½å¥–)/.test(errorMessage)) {\n                if (this.isCommonAct) {\n                    await this.api('wxShopFollowActivity/follow', `activityId=${this.activityId}&pin=${this.Pin}`);\n                    await this.wait(1000, 2000)\n                    return await this.api(fn, param, config, ++count);\n                }\n            }\n            const autoCached = this.match(autoCachedRegx, errorMessage);\n            if (autoCached) {\n                await this.runCached()\n            }\n            const autoCachedForever = this.match(autoCachedForeverRegx, errorMessage);\n            if (autoCachedForever) {\n                await this.runCachedForever()\n            }\n            await this['breakLoopThrows'](headers, data, errorMessage)\n            await this['foreverHotThrows'](headers, data, errorMessage)\n            if (retryApiKeywordRegx.test(errorMessage) && !data.str1Param) {\n                return await this.api(fn, param, config, ++count);\n            }\n            this.putMsg(errorMessage)\n        }\n        return data\n    } catch (e) {\n        if ([422].includes(e.status)) {\n            throw e\n        }\n        if (!e instanceof CustomError && !disableLogUrlRegx.test(fn)) {\n            this.log(`APIå¼‚å¸¸ ${count}`, fn)\n        }\n        if ([403, 493, 502, 555].includes(e.status)\n            || ['ECONNABORTED', 'ECONNREFUSED', 'ETIMEDOUT', 'ECONNRESET'].includes(e.code)\n            || (this.retryRegx && new RegExp(`(${this.retryRegx.split(\"@\").join(\"|\")})`).test(e.message))) {\n            if ([493].includes(e.status) && this.currentIp && this.currentIp.includes(\":\")) {\n                this.log(`æ‹‰é»‘IP ${this.currentIp}`)\n                const host = this.currentIp.split(\":\")[0];\n                await this.rcache(`${getValue(\"M_PROXY_IPS_BLACK_KEY\", 'M_PROXY_IPS_BLACK')}:${host}`, host, 2 * 60 * 60 * 1000)\n            }\n            this.currentIp = \"\"\n            return await this.api(fn, param, config, ++count);\n        }\n\n        if (!e instanceof CustomError && typeof data == 'undefined') {\n            this.log(\"no dataé‡è¯•\")\n            return await this.api(fn, param, config, ++count);\n        }\n        if ([500].includes(e.status) && this.super?.defenseUrls && this.super.defenseUrls?.length && this.super.defenseUrls.includes(\n            fn.startsWith(\"/\") ? fn : `/${fn}`)) {\n            await this.initPinToken();\n            return await this.api(fn, param, config, ++count);\n        }\n        if ([301].includes(e.status) && /(login)/.test(fn)) {\n            await this.runCacheForeverHot(true);\n            this.putMsg('é»‘å·')\n            throw e\n        }\n        if (e instanceof CustomError) {\n            throw e\n        }\n    }\n}",
      "async function api(fn, param = \"\", config = {}, count = 0) {\n    const {data} = await this.request(fn, param, config);\n    return data\n}"
    ],
    "base64ModEncode": [
      "function base64ModEncode(e, charset) {\n    charset = charset || 'KLMNOPQRSTABCDEFGHIJUVWXYZabcdopqrstuvwxefghijklmnyz0123456789+/';\n    var t = \"\";\n    var n, r, i, s, o, u, a;\n    var f = 0;\n    e = this.utf8Encode(e);\n    while (f < e.length) {\n        n = e.charCodeAt(f++);\n        r = e.charCodeAt(f++);\n        i = e.charCodeAt(f++);\n        s = n >> 2;\n        o = (n & 3) << 4 | r >> 4;\n        u = (r & 15) << 2 | i >> 6;\n        a = i & 63;\n        if (isNaN(r)) {\n            u = a = 64\n        } else if (isNaN(i)) {\n            a = 64\n        }\n        t = t + charset.charAt(s) + charset.charAt(o) + charset.charAt(u) + charset.charAt(a)\n    }\n    while (t.length % 4 > 1) {\n        t += '=';\n    }\n    return t\n}",
      "function base64ModEncode(e, charset) {\n    charset = charset || 'KLMNOPQRSTABCDEFGHIJUVWXYZabcdopqrstuvwxefghijklmnyz0123456789+/';\n    var t = \"\";\n    var n, r, i, s, o, u, a;\n    var f = 0;\n    e = this.utf8Encode(e);\n    while (f < e.length) {\n        n = e.charCodeAt(f++);\n        r = e.charCodeAt(f++);\n        i = e.charCodeAt(f++);\n        s = n >> 4;\n        o = (n & 3) << 2 | r >> 2;\n        u = (r & 10) << 1 | i >> 3;\n        a = i & 64;\n        if (isNaN(r)) {\n            u = a = 62\n        } else if (isNaN(i)) {\n            a = 61\n        }\n        t = t + charset.charAt(s) + charset.charAt(o) + charset.charAt(u) + charset.charAt(a)\n    }\n    while (t.length % 4 > 1) {\n        t += '=';\n    }\n    return t\n}"
    ],
    "breakLoopThrows": [
      "async function breakLoopThrows(headers, data, errorMessage) {\n    const breakKeyword = this.match(breakKeywordRegx, errorMessage);\n    if (breakKeyword) {\n        this.putMsg(errorMessage)\n        if (/(æ˜æ—¥å†æ¥å§|æœªå¼€å§‹)/.test(errorMessage)) {\n            this.super.exit = true\n            throw new CustomError(errorMessage)\n        }\n        this.exit = true\n        throw new CustomError(errorMessage)\n    }\n}",
      "async function breakLoopThrows(headers, data, errorMessage) {\n    this.super.exit = true\n    throw new CustomError(errorMessage)\n}"
    ],
    "checkExitActName": [
      "function checkExitActName(actName = this.super.actName) {\n    if (!actName || this.super.isCheckExitActName) {\n        return\n    }\n    const result = this.match(exitActNameKeywordRegx, actName);\n    if (result) {\n        throw new CustomError(`ä¾æ®æ ‡é¢˜,åƒåœ¾æ´»åŠ¨,#${result}`)\n    }\n    this.super.isCheckExitActName = true\n}"
    ],
    "checkExitPrize": [
      "async function checkExitPrize() {\n    if (!this.super.prizeList.length || this.super.hasRun || this.super.exit || this.filename.includes(\n        \"address\")) {\n        return\n    }\n    let lock = await this.acquireLock(this.activityId, this.activityId, 1000);\n    if (!lock) {\n        return\n    }\n    this.log(\"å¼€å¯ å¥–åŠ±åˆ—è¡¨æ£€æµ‹é”\")\n    try { //å¥–å“æ•°é‡\n        let usefulPrizes = this.super.prizeList\n        try {\n            usefulPrizes = this.filterPrizes()\n        } catch (e) {\n            this.getEnv('M_DEBUG_LOG', false) && this.log(e)\n        }\n        this.getEnv('M_DEBUG_LOG', false) && this.log('è¿‡æ»¤å', usefulPrizes)\n        if (!usefulPrizes.length && !this.isMaster()) {\n            this.putMsg(\"#ä¾æ®å¥–åŠ±ï¼Œåƒåœ¾æ´»åŠ¨\")\n            this.super.exit = true\n            throw new CustomError(\"é€»è¾‘ç»ˆæ­¢\")\n        }\n        this.super.hasRun = true;\n    } finally {\n        this.getEnv('M_DEBUG_LOG', false) && this.log(\"é‡Šæ”¾ å¥–åŠ±åˆ—è¡¨æ£€æµ‹é”\")\n        await this.releaseLock(this.activityId, this.activityId)\n    }\n}",
      "async function checkExitPrize() {\n    this.super.exit = true\n    return true\n}"
    ],
    "cookieEnv": [
      "async function cookieEnv() {\n    this.uuid = this.randomString(40)\n    this.sid = CryptoJS.SHA1(this.ptpin).toString()\n    this.ud = this.base64ModEncode(this.sid)\n    this.un_area = this.randomPattern('xx_xxxx_xxxx_xxxxx', this.ALL_DIGIT);\n    this.originCookie = this.cookie\n    this.cookie = `${this.cookie}pwdt_id=${this.ptpin};sid=${this.sid};pre_seq=1;pre_session=${this.sid}|567;_jda=122270672.17169117196521267266995.1716911719.1716911719.1716911719.1; __jdb=122270672.1.17169117196521267266995|1.1716911719; __jdc=122270672; __jdv=122270672%7Cdirect%7C-%7Cnone%7C-%7C1716911719652; mba_muid=17169117196521267266995.1.1716911719652;`\n    const name = 'jd';\n    this.osVer = osver[Math.floor(Math.random() * osver.length)];\n    this.sua = `iPhone; CPU iPhone OS ${this.osVer.replace(\".\", \"_\")} like Mac OS X`;\n    this.app = this.app || clients[name]['app'];\n    this.client = (this.client || clients[name].client) === 'ios' ? 'iPhone' : 'android';\n    this.clientVersion = this.clientVersion || clients[name].clientVersion;\n    this.appBuild = this.appBuild || clients[name]['appBuild'];\n    this.ep = encodeURIComponent(JSON.stringify({\n        \"ciphertype\": 5,\n        \"cipher\": {\n            \"ud\": this.ud, \"sv\": this.base64ModEncode(this.sid), \"iad\": '',\n        },\n        \"ts\": Date.now(),\n        \"hdid\": \"JM9F1ywUPwflvMIpYPok0tt5k9kW4ArJEU3lfLhxBqw=\",\n        \"version\": \"1.0.3\",\n        \"appname\": \"com.360buy.jdmobile\",\n        \"ridx\": -1,\n    }))\n    this.UA = [this.app, this.client, this.clientVersion, '', this.sid, 'M/5.0;hasUPPay/0;pushNoticeIsOpen/0;lang/zh_CN;hasOCPay/0',\n        `appBuild/${this.appBuild}`, 'supportBestPay/0;jdSupportDarkMode/0;ef/1', `ep/${this.ep}`,\n        `Mozilla/5.0 (${this.sua}) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148;supportJDSHWK/1`].join(';')\n    users.set(this.ptpin, this)\n    return this;\n}",
      "async function cookieEnv() {\n    this.uuid = this.randomString(40)\n    this.sid = CryptoJS.SHA1(this.ptpin).toString()\n    this.ud = this.sid + this.uuid\n    this.whwswswws = 'JD0111d47' + this.randomString(334, this.ALL_ALPHABET)\n    this.devicefinger = 'eidIfbbb' + this.randomString(108, this.ALL_ALPHABET);\n    this.unionwsws = encodeURIComponent(JSON.stringify({\"jmafinger\": this.whwswswws, \"devicefinger\": this.devicefinger}))\n    this.un_area = this.randomPattern('xx_xxxx_xxxx_xxxxx', this.ALL_DIGIT);\n    return this;\n}"
    ],
    "countdown": [
      "async function countdown(mode = 1, s = 1000) {\n    if (s <= 0) {\n        return\n    }\n    let d = new Date();\n    if ((mode === 1 && d.getMinutes() < 50) || (mode === 2 && d.getMinutes() < 25) || (mode === 3 && d.getMinutes() < 10) || (mode === 4\n        && d.getMinutes() < 5)) {\n        return\n    }\n    let st = s;\n    if (mode !== 9) {\n        switch (mode) {\n            case 1:\n                d.setHours(d.getHours() + 1);\n                d.setMinutes(0)\n                break\n            case 2:\n                d.setMinutes(30)\n                break\n            case 3:\n                d.setMinutes(15)\n                break\n            case 4:\n                d.setMinutes(10)\n                break\n            default:\n                this.log(\"ä¸æ”¯æŒ\")\n        }\n        d.setSeconds(0)\n        d.setMilliseconds(0)\n        st = d.getTime() - Date.now() - s\n    }\n    if (st > 0) {\n        this.log(`éœ€è¦ç­‰å¾…æ—¶é—´${st / 1000} ç§’`);\n        await this.wait(st)\n    }\n}"
    ],
    "decrypt": [
      "function decrypt(method, mode, padding, message, key, iv, messageEncode = \"Base64\", toStringEncode = \"Utf8\") {\n    const data = CryptoJS[method].decrypt({ciphertext: CryptoJS.enc[messageEncode].parse(message)}, CryptoJS.enc.Utf8.parse(key),\n        {mode: CryptoJS.mode[mode], padding: CryptoJS.pad[padding], iv: CryptoJS.enc.Utf8.parse(iv)}).toString(\n        CryptoJS.enc[toStringEncode]);\n    return ((data.startsWith(\"{\") && data.endsWith(\"}\")) || (data.startsWith(\"[\") && data.endsWith(\"]\"))) ? JSON.parse(data) : data;\n}",
      "function decrypt(method, mode, padding, message, key, iv, messageEncode = \"Base64\", toStringEncode = \"Utf8\") {\n}\n"
    ],
    "encrypt": [
      "function encrypt(method, mode, padding, message, key, iv, messageEncode = \"Utf8\", toStringEncode = \"Base64\") {\n    return CryptoJS[method].encrypt(CryptoJS.enc[messageEncode].parse(typeof message === 'string' ? message : JSON.stringify(message)),\n        CryptoJS.enc.Utf8.parse(key),\n        {mode: CryptoJS.mode[mode], padding: CryptoJS.pad[padding], iv: CryptoJS.enc.Utf8.parse(iv)}).ciphertext.toString(\n        CryptoJS.enc[toStringEncode]);\n}",
      "function encrypt(method, mode, padding, message, key, iv, messageEncode = \"Utf8\", toStringEncode = \"Base64\") {\n}\n"
    ],
    "followShop": [
      "async function followShop(shopId, follow = true) {\n    const {sign} = await this.sign(\"followShop\", {\n        follow: follow, shopId: shopId, award: false, sourceRpc: \"shop_app_home_follow\",\n    })\n    let url = `https://api.m.jd.com/client.action?functionId=followShop`\n    await this.api(url, sign);\n}",
      "async function followShop(shopId, follow = true) {\n    const {sign} = await this.sign(\"followShop\", {\n        shopId: shopId,  sourceRpc: \"shop_app_home\",\n    })\n    let url = `https://api.m.jd.com/client.action?functionId=followShop`\n    await this.api(url, sign);\n}"
    ],
    "foreverHotThrows": [
      "async function foreverHotThrows(headers, data, errorMessage) {\n    const autoCachedForeverHot = this.match(autoCachedForeverHotRegx, errorMessage);\n    if (autoCachedForeverHot) {\n        this.putMsg(errorMessage)\n        this.exit = true\n        await this.runCacheForeverHot(this.isGzslAct);\n        throw new CustomError(errorMessage)\n    }\n    if (/(AUTH.FAILED.VALID|AUTH.FAILED.BLACK)/.test(data?.data)) {\n        await this.runCacheForeverHot();\n        this.putMsg(data.data)\n        this.exit = true\n        throw new CustomError(data.data)\n    }\n    if (/(FANS_RISK)/.test(data?.str1Param)) {\n        await this.runCacheForeverHot(true);\n        this.putMsg(data.str1Param)\n        this.exit = true\n        throw new CustomError(data.str1Param)\n    }\n    if (this.isHdbAct && /(æ´»åŠ¨å¤ªç«çˆ†äº†!è¯·ç¨åå†è¯•ï½)/.test(errorMessage)) {\n        await this.runCacheForeverHot();\n        this.putMsg(data.str1Param)\n        this.exit = true\n        throw new CustomError(data.str1Param)\n    }\n}",
      "async function foreverHotThrows(headers, data, errorMessage) {\n    await this.runCacheForeverHot();\n    throw new CustomError(errorMessage)\n}"
    ],
    "getH5st": [
      "async function getH5st(param, algoUrl = this.activityUrl || \"https://api.m.jd.com/client.action\") {\n    let {params,h5st} = await utopia.h5st.getH5st({\n        appId: param.appId,\n        functionId: param.functionId,\n        appid: param.appid,\n        client: this.client,\n        clientVersion: this.clientVersion,\n        body: param.body,\n        version: param.version ||'4.7',\n        ua: param.ua||this.UA,\n        t: true,\n    })\n    return {params, h5st}\n}",
      "async function getH5st(param, algoUrl = this.algoUrl || \"https://api.m.jd.com/client.action\") {\n    const version = param.version || \"4.3\"\n    const h5 = new h5stVersions[version](this.UA, param.appId, this.ptpin);\n    await h5.requestAlgo(algoUrl)\n    const data = {\n        functionId: param.functionId,\n        body: JSON.stringify(param.body),\n        t: Date.now(),\n        appid: param.appid,\n        client: this.client,\n        clientVersion: this.clientVersion,\n    }\n    !param.t && delete data.t;\n    delete data.ua\n    delete data.version\n    const decrypt = h5.decrypt(data, Object.keys(data).sort())\n    return {params: `${new URLSearchParams(data).toString()}&h5st=${decrypt}`, h5st: decrypt}\n}"
    ],
    "getShopInfo": [
      "async function getShopInfo(venderId = this.super.venderId, shopId = this.super.shopId) {\n    if (this.super.shopName&& !this.fixedShopName) {\n        return\n    }\n    let data = \"\"\n    if (venderId && !this.fixedShopName) {\n        let cache = await redis.hget(\"VENDER_ID\", venderId)\n        if (cache) {\n            data = JSON.parse(cache)\n        }\n    }\n    if (!data && shopId && !this.fixedShopName) {\n        let cache = await redis.hget(\"SHOP_ID\", shopId)\n        if (cache) {\n            data = JSON.parse(cache)\n        }\n    }\n    try {\n        if (!data || !data.shopName) {\n            const checkChat = await this.api(\n                `https://chat1.jd.com/api/checkChat?callback=jQuery7749929&${venderId ? 'venderId' : 'shopId'}=${venderId\n                || shopId}&_=${Date.now()}`, \"\", {\n                    \"authority\": \"chat1.jd.com\", \"Referer\": `https://mall.jd.com/shopBrandMember-${venderId || shopId}.html`\n                })\n            try {\n                data = JSON.parse(checkChat.replace(/^jQuery\\d+\\(/, \"\")?.replace(/\\);$/, \"\"));\n            } catch (e) {\n                data =  checkChat\n            }\n            if (data.seller) {\n                await redis.hset(\"VENDER_ID\", data.venderId,\n                    JSON.stringify({shopName: data.seller, shopId: data.shopId, venderId: data.venderId}))\n                await redis.hset(\"SHOP_ID\", data.shopId,\n                    JSON.stringify({shopName: data.seller, shopId: data.shopId, venderId: data.venderId}))\n            }\n        }\n        if (data.venderId) {\n            this.super.shopName = data.shopName || data.seller\n            this.super.shopId = data.shopId\n            this.super.venderId = data.venderId\n            this.log(`${this.super.shopName} ${this.super.shopId} ${this.super.venderId}`)\n        }\n    } catch (e) {\n        this.log(\"getShopInfo \" + e)\n    }\n}",
      "async function getShopInfo(venderId = this.super.venderId, shopId = this.super.shopId) {\n    this.super.shopId = $.shopId\n    this.super.venderId = $.venderId\n    this.log(`${this.super.shopName} ${this.super.shopId} ${this.super.venderId}`)\n}"
    ],
    "initConfig": [
      "async function initConfig(){\n    const h5st = require(\"./commonH5st.js\");\n    utopia.h5st = h5st;\n    this.exitLimitCount = 0\n    this.handConfirm = 0\n    this.shareCodes = []\n    this.ALL_HEX = '0123456789abcdef';\n    this.ALL_ALPHABET = 'qwertyuiopasdfghjklzxcvbnm';\n    this.attrTouXiang = 'https://img10.360buyimg.com/imgzone/jfs/t1/21383/2/6633/3879/5c5138d8E0967ccf2/91da57c5e2166005.jpg'\n    this.v2Key = \"YKAHdmG5W5ONsm9Q\";\n    this.v2Iv = \"sAog2JjE2YUvJA==\";\n    exitKeywordRegx = new RegExp(`(è¯¥å•†å®¶æ²¡æœ‰å¼€é€šç§¯åˆ†ä¼šå‘˜|å¥–å“å·²å‘å®Œï¼|åº—é“ºç¤¼åŒ…å·²ç»ä¸å­˜åœ¨|ä½™é¢ä¸è¶³|æ´»åŠ¨ä¸å­˜åœ¨|ä»Šå¤©çš„å¥–å“æŠ¢å…‰äº†|æ²¡æœ‰è®¢è´­äº¬è€•!|åƒåœ¾æ´»åŠ¨|å¾ˆæŠ±æ­‰ï¼Œæ‚¨æ¥æ™šäº†ï¼Œå¥–å“å·²å‘å®Œ|è®¢å•å·²ä»˜æ¬¾ä¸”é‡‘é¢è¾¾åˆ°|æ´»åŠ¨å·²ç»ç»“æŸ|æœ¬æœŸæ´»åŠ¨ç¤¼å“å‘æ”¾å®Œ|åº—é“ºIDä¸å•†å®¶IDä¸åŒ¹é…|æ´»åŠ¨æœªå¼€å§‹|å•†å®¶è®¢è´­è¿‡æœŸ|æ­¤äº¬è±†è®¡åˆ’å·²ç»ç»“æŸ|å…³æ³¨åº—é“ºå¤±è´¥|å•†å®¶åº”ç”¨è®¢è´­å·²è¿‡æœŸ|äº¬è±†è®¡åˆ’ä½™é¢ä¸è¶³|ç³»ç»Ÿé”™è¯¯ï¼Œè¯·è”ç³»å®¢æœ|æ´»åŠ¨å·²ç»“æŸ|äº¬è±†è®¡åˆ’ä¸­æ— è¶³å¤Ÿçš„äº¬è±†|é¡¹ç›®å·²ç»“æŸ|è¯·è”ç³»å®¢æœå¡«å†™åœ°å€|å½“å‰æ´»åŠ¨å°šæœªå¼€å§‹|æ´»åŠ¨å¥–å“å·²ç»å‘å®Œäº†|åº—é“ºé»‘åå•)`)\n    exitRuleKeywordRegx = new RegExp(`(æ´»åŠ¨æœŸé—´å•ç¬”æ¶ˆè´¹æ»¡æŒ‡å®šé‡‘é¢æ‰èƒ½é¢†å–|ä¸­å¥–ç”¨æˆ·ä¸‹å•æŒ‡å®šé‡‘é¢|åˆ°è´§åè”ç³»å®¢æœ|åœ¨æœ¬åº—æ¶ˆè´¹|å¥–å“éœ€ä»˜æ¬¾è®¢å•é¢†å–|å•æ‹ä¸å‘è´§|å®ç‰©å¥–å“éœ€è´­ä¹°åº—é“ºäº§å“å®ä»˜æ»¡|ä¸­å¥–å®ç‰©ç”¨æˆ·éœ€è¦è´­ä¹°åº—é“ºäº§å“é¢†å–|éšå•†å“å¯„å‡º|è®¢å•å·é¢†å–|å®ç‰©èµ å“éœ€è´­ä¹°|å®ç‰©å¥–é‡‡å–éšå•æ–¹å¼å‘æ”¾|éœ€è´­ä¹°åº—é“ºå•†å“|éšè´­ä¹°çš„å•†å“ä¸€èµ·å‘å‡º|å®ç‰©å¥–å“å°†åœ¨è®¢å•ç¡®è®¤æ”¶è´§åå®‰æ’å¯„é€|å¥–å“éœ€è´­ä¹°|è¯·éšåŒ…é‚®äº§å“ä¸‹å•|ä¸­å¥–é¡¾å®¢éœ€è´­ä¹°åº—é“º|æœŸé—´è´­ä¹°æœ¬åº—é“º|éœ€åœ¨æœ¬åº—è´­ä¹°|ä¸€èµ·å‘è´§|åº—é“ºæ¶ˆè´¹|ä¸‹å•å¯¹åº”|å‡­è®¢å•æˆªå›¾|æ—¶é—´æ®µå†…ä¸‹å•å¹¶ä»˜æ¬¾ï¼Œä¸”å•ç¬”è®¢å•é‡‘é¢æ»¡|éœ€åœ¨æœ¬åº—æœ‰ä¸‹å•|æœŸé—´ä¸‹å•ä¸”è®¢å•å·²å®Œæˆæ‰èƒ½å‚ä¸æŠ½å¥–|æä¾›ä¸­å¥–æˆªå›¾|å®ç‰©å¥–å“éœ€è´­ä¹°|è”ç³»å®¢æœéšå•å¯„å‡º|ä¸­å¥–è€…æ´»åŠ¨æœŸå†…éœ€æœ‰æˆåŠŸè®¢å•è®°å½•|é¢†å–éœ€å‡­å€Ÿ|è®¢å•ç­¾æ”¶å|å¿…é¡»æ˜¯åœ¨åº—é“ºè´­ä¹°çš„äººæ‰å¯å‚åŠ |æœ¬åº—å®ä»˜æ»¡|åœ¨é¡¾å®¢ç¡®è®¤æ”¶è´§|ç¡®è®¤æ”¶è´§åå³å¯é¢†å–å¥–å“|éœ€æ­é…æ­£è£…ä¸‹å•|æœ¬åº—è´­æœºç”¨æˆ·|é™å®š4Tä»¥ä¸Šæœºæ¢°ç¡¬ç›˜äº§å“å‚åŠ |æœŸé—´ä¸‹å•å¹¶ä»˜æ¬¾æˆåŠŸ|å®ç‰©å¥–å“éœ€è´­ä¹°åº—é“ºäº§å“|æ—¶é—´æ®µå†…ä¸‹å•å…¨éƒ¨å•†å“|äº§å“åå®‰æ’å‘è´§|éœ€å‡­å€Ÿå•ç¬”å®ä»˜|ç§¯åˆ†æ¢è´­ä»·æ ¼|ç¡®è®¤æ”¶è´§åè”ç³»å®¢æœå‘å‡º|æŠ½ä¸­å®ç‰©å¥–å“çš„å®¢æˆ·éœ€åœ¨æ´»åŠ¨æœŸé—´|å¿…é¡»è´­ä¹°åº—é“ºå†…|ä¸‹å•å³å¯å‚ä¸æŠ½å¥–|å®ç‰©èµ å“ä¸å•å‘|è½®èƒå®‰è£…å®Œæˆä¹‹åè”ç³»åœ¨çº¿å®¢æœ|å®ç‰©å¥–ä¼šåœ¨è®¢å•å®Œæˆ|éšè®¢å•å‘å‡º|éœ€ä¸‹å•åº—é“ºå•†å“ç™»è®°å‘è´§|å­˜åœ¨æœ‰æ•ˆè®¢å•|è½®èƒå®‰è£…å®Œæˆä¹‹å|è´­ä¹°ä¸»æœºæ–¹å¯å‚ä¸|ä»…é™åœ¨æŠ½å¥–æ´»åŠ¨æ——èˆ°å†…è´­ä¹°|éœ€åœ¨æ´»åŠ¨æœŸé—´å®ä»˜æ»¡|éœ€è´­ä¹°åº—é“ºå†…|åº—é“ºä¸‹å•ä»˜æ¬¾|ç¡®è®¤æ”¶è´§åè¯·ä¸å®¢æœè”ç³»æä¾›ä¸­å¥–è®°å½•|å¥–å“å‘æ”¾éœ€è¦åº—é“ºæ¶ˆè´¹æ»¡|ç”¨æˆ·åœ¨æ´»åŠ¨æ—¶é—´å†…ä¸‹å•è´­ä¹°|è®¢å•ç¡®è®¤æ”¶è´§|éœ€è¦ç¡®è®¤æ”¶è´§åè¿›è¡Œæ™’å•|æ´»åŠ¨æ—¶é—´å†…æˆåŠŸä»˜æ¬¾å|éœ€æ‹ä¸‹æ´»åŠ¨|éœ€åœ¨åº—é“ºå†…è´­ç‰©è¶…æŒ‡å®šé‡‘é¢|æ—¥æœŸé—´ä¸€æ¬¡ä¸‹å•é‡‘é¢æ»¡\\d+å…ƒå¹¶ä¸”å®Œæˆè®¢å•|æœªåœ¨æœ¬åº—é“ºè´­ä¹°æœºå™¨ç”¨æˆ·|ä¸‹è¿‡å•|å•ç‹¬å¥–å“ä¸å‘è´§|å¦‚è®¢å•å°šå¤„åœ¨å¾…å‘è´§ã€æœªç­¾æ”¶ã€æœªå–ä»¶ã€ç­‰éæˆ‘æ–¹å› ç´ å¯¼è‡´çš„å¼‚å¸¸çŠ¶æ€ï¼Œåˆ™å–æ¶ˆä¸­å¥–èµ„æ ¼|éœ€æœ¬åº—è´­ç‰©å®ä»˜é‡‘é¢æ»¡\\d+å…ƒ|å®ç‰©å¥–ä¸‹å•æ‰é€|éœ€åœ¨æœ¬åº—é“ºå†…ä¸‹å•|åœ¨æœ¬åº—å®ä»˜é‡‘é¢æ»¡|å…ƒæ‰èƒ½å‚ä¸æŠ½å¥–|éœ€è´­ä¹°åº—é“ºä»»æ„ä¸»å•†å“å¹¶ç¡®è®¤æ”¶è´§å|ç¡®è®¤æ”¶è´§åè”ç³»å®¢æœ|ä¸‹å•è´­ä¹°å†…æ´»åŠ¨å‚ä¸å•†å“|å®ç‰©å¥–éœ€è¦åœ¨åº—å†…è´­ä¹°|åº—é“ºæ¶ˆè´¹å•ç¬”è®¢å•|ä»¥åŠä¸‹å•è®¢å•å·|è´­ä¹°å¹¶å®Œæˆè®¢å•è”ç³»åœ¨çº¿å®¢æœ|ä¸­å¥–åéœ€ä¸‹å•|å¥–å“éœ€åœ¨è®¢å•å®Œæˆå|è´­ä¹°æŒ‡å®šå•†å“åæ–¹å¯é¢†å–å¥–å“|ä¸­å¥–ç”¨æˆ·è¯·åœ¨ç¡®è®¤æ”¶è´§ä¹‹å|ä¸‹å•æŒ‡å®šå‹å·|ä¸­å¥–æˆªå›¾åŠæœ¬åº—è®¢å•æ”¶è´§|æ”¶åˆ°è´§å|èµ å“å‡éœ€è¦ä¸‹å•|å®Œæˆè®¢å•æˆªå›¾|å¥–å“ä¸å•ç‹¬å‘å‡º|æœ¬åº—è´­ä¹°äº§å“ç”¨æˆ·|è®¢å•ç¡®è®¤æ”¶è´§åå†æ¬¡è”ç³»å®¢æœå‘å‡ºå¥–å“|ä¸­å¥–ä½†æœªè´­ä¹°åº—é“ºäº§å“|ç”¨æˆ·éœ€æœ‰æœ¬åº—é“ºè®¢å•å®ä»˜æ»¡|æ—¶é—´æ®µå†…ä¸‹å•ï¼Œå•ç¬”è®¢å•é‡‘é¢|æœ‰æ•ˆé¡»æ»¡è¶³|ä»…é™è´­ä¹°è¿‡çš„é¡¾å®¢å‚ä¸|éšå•å‘è´§|éœ€åœ¨æœ¬åº—é“ºè´­ä¹°å•†å“åæ–¹å¯å…‘å¥–|å®ç‰©ä¸­å¥–å®¢æˆ·éœ€åœ¨åº—é“ºæ¶ˆè´¹æ»¡|è®¢å•ä¸€èµ·å‘å‡º|æœªè´­ä¹°æœºå™¨æŠ½ä¸­å®ç‰©çš„ï¼Œä¸æ”¯æŒå•å‘|å®Œç»“è®¢å•æˆªå›¾å’¨è¯¢åœ¨çº¿å®¢æœé¢†å¥–|è´­ä¹°å•†å“åä»¥é€€æ¬¾å½¢å¼å®ç°|ä¸­å¥–åè¯·è”ç³»å®¢æœå‘å‡ºèµ å“|éœ€è¦ç¡®è®¤æ”¶è´§åæ‰ä¼šå‘å‡º|ä¸­å¥–ç”¨æˆ·éœ€åœ¨æœ¬åº—æˆåŠŸæ”¯ä»˜|ä¸‹è®¢è®¢å•å·|æä¾›ä¸­å¥–æˆªå›¾å’ŒæˆåŠŸè´­|æ”¶è´§å®Œæˆè®¢å•|éƒ½éœ€è¦ä¸‹å•è´­ä¹°æ”¶åˆ°ä¸»å•†å“|æ‹ä¸‹è¯•é©¾å•†å“|ä¸‹å•å®¢æˆ·æ‰èƒ½å…‘æ¢å¥–å“|æœŸé—´æˆåŠŸè´­ä¹°|å®ç‰©å¥–éœ€æ´»åŠ¨æœŸé—´åœ¨æœ¬åº—ä¸‹å•è´­ä¹°|è®¢å•è®°å½•æ‰èƒ½é¢†å–è·å¥–å®ç‰©|æ”¶è´§åè”ç³»å®¢æœæ™’å•é¢†å–|å¥–å“ä¸æ”¯æŒå•ç‹¬é‚®å¯„|éšå•å‘å‡º|å®ç‰©ä¸­å¥–å®¢æˆ·éœ€åœ¨åº—é“ºæ¶ˆè´¹|éœ€è´­ä¹°åº—é“ºæŒ‡å®šå•†å“æ”¶è´§å|äº¬ä¸œè®¢å•å®Œæˆæˆªå›¾|æŠ½ä¸­çš„å¥–å“å¿…é¡»æˆåŠŸè´­ä¹°|æ‹ä¸‹ä¸“å±å…‘ç¤¼é“¾æ¥åå‘å‡º|å¹¶æ”¶è´§å®Œæˆè®¢å•|éœ€ä¸‹å•éšå•èµ é€|ä¸­å¥–ä¹‹åéœ€24å°æ—¶å†…åœ¨åº—é“ºä¸‹å•æˆåŠŸ|æœ‰çœŸå®è´­ä¹°è®°å½•|éœ€è¦åœ¨æœ¬åº—ä¸‹å•|å®¢æˆ·ä¸­å¥–åéœ€æä¾›ä¸‹å•è®¢å•å·)`)\n    exitActNameKeywordRegx = new RegExp(`(LV2|ç§¯åˆ†å…‘æ¢ä¼˜æƒ åˆ¸|LV4|å‚¨å€¼é‡‘|è´­æœº|é¦–è´­|ç§¯åˆ†åŠ é’±è´­|LV3)`)\n    ruleSimplifyKeywordRegx = new RegExp(`(ä¸åŒè´¦å·é‡å¤å‚ä¸æ´»åŠ¨|é¢„è®¡24å°æ—¶åˆ°è´¦|å…ˆåˆ°å…ˆå¾—|è‹¹æœå…¬å¸|æ³¨æ„äº‹é¡¹|ä¸å¾—æç°|è™šæ‹Ÿå•†å“|è§†ä¸ºåŒä¸€ä¸ªç”¨æˆ·|ç¬¦åˆè¿ç»­ç­¾åˆ°èµ é€æ¡ä»¶|è®¢å•ä¿¡æ¯å¯èƒ½ç¨æœ‰å»¶è¿Ÿ|æ•°é‡ä»·å€¼|æ¶æ„è¡Œä¸º|è‹¥å¼€å¡æ—¶é—´åœ¨æ´»åŠ¨èŒƒå›´å†…|åå°ç»Ÿè®¡ç»“æœä¸ºå‡†|è‡ªåŠ¨å‘æ”¾|ç¬¦åˆç´¯è®¡ç­¾åˆ°èµ é€æ¡ä»¶|æ‰‹åŠ¨é¢†å–|å¥–å“å‘æ”¾å½¢å¼|å‡¡ä»¥ä¸æ­£å½“æ‰‹æ®µ|æŠ½å¥–æœºä¼š|å®Œæˆç›¸åº”ä»»åŠ¡|é¢„å”®è®¢å•éœ€æ”¯ä»˜|æ´»åŠ¨å‚ä¸ä¸»ä½“èµ„æ ¼|å…‘æ¢ç›¸å…³ç¤¼å“|å…¨ç½‘å®¢æˆ·|æ‰å¯é¢†å–å¥–å“|è™šæ‹Ÿäº§å“å¥–|å®šæœŸå˜æ›´|é¢„å”®å•†å“|å®ŒæˆæŒ‡å®šä»»åŠ¡å|æä¾›æŠ€æœ¯æ”¯æŒ|å…³æ³¨åº—é“ºå|å…³æ³¨åº—é“º|æ‰‹åŠ¨å…‘æ¢|å› å¹³å°è®¢å•æ¥å£é™æµ|ä¸­å¥–åå•|å¦‚é‡ä¸å¯æŠ—åŠ›|ç­¾åˆ°è®°å½•æ¸…é›¶|ä¸­å¥–å®¢æˆ·ä¿¡æ¯æ”¶é›†|ç­¾åˆ°æˆåŠŸåæœ‰æœºä¼šè·å¾—å¥–å“|å±•ç¤ºä¸­å¥–åå•)`)\n    exitShopKeywordRegx = new RegExp(`(éœ‡æ—¦äº¬ä¸œè‡ªè¥æ——èˆ°åº—|ç¾Šç¾Š100å®˜æ–¹æ——èˆ°åº—|é©¬å¯æ³¢ç½—|é¡¾å®¶å®¶å±…å¨æˆ¿å«æµ´æ——èˆ°åº—|å®œå“æ——èˆ°åº—|åˆ›å“æœªæ¥ç”µè„‘æ——èˆ°åº—|è““åº·åƒ–|å¥½è±å®¢å®˜æ–¹æ——èˆ°åº—|å®ç¢è“æ˜Ÿä¸“å–åº—|SMSPADE|ç»´å…‹ç‰¹ç¿ä¸“å–åº—|ç´ç‘å„ª|å¥¥å…‹æ–¯ç©ºè°ƒåå—ç››å…ƒä¸“å–åº—|å¥½è±å®¢å®¶è£…å»ºææ——èˆ°åº—|å°ç±³å»ºæä¸“å–åº—|a2è¾°ç¡•ä¸“å–åº—|æµ·å°”æ´—è¡£æœºç”Ÿæ€æ——èˆ°åº—|æœºæ¢°é©å‘½æˆæƒæ——èˆ°åº—|Maxi-Cosiæ——èˆ°åº—|ç®­ç‰Œå¨æˆ¿å«æµ´äº¬ä¸œè‡ªè¥ä¸“å–åº—|å›ä¹å®å®˜æ–¹ä¸“å–åº—|æ¾ä¸‹ä¸ªäººæŠ¤ç†æ——èˆ°åº—|å‡¤å‡°è‡ªè¡Œè½¦æ——èˆ°åº—|è‘£æ˜ç |å›ä¹å®å¥¶ç²‰æ——èˆ°åº—|ç´¢è²äºšå®˜æ–¹æ——èˆ°åº—|æ——å¸œå¥¶ç²‰æ——èˆ°åº—|å›ä¹å®ä¿è´ä¸“å–åº—|æƒ æ™®è“æ˜Ÿä¸“å–åº—|æµ·å°”é¸¿ç¨‹æ°¸æ³°ä¸“å–åº—|èƒ½ç‡ï¼ˆNORITZï¼‰å£æŒ‚ç‚‰äº¬ä¸œè‡ªè¥æ——èˆ°åº—|æ­¦æç”µè„‘DIYæ——èˆ°åº—|ç¾çš„ï¼ˆMideaï¼‰ç©ºè°ƒä¼ä¸šè´­äº¬ä¸œè‡ªè¥æ——èˆ°åº—|æƒ æ™®è¿ˆå‘ä¸“å–åº—|ä¸ƒé‡Œå›¤é£Ÿå“ä¼˜é€‰åº—|æœ‰æ£µæ ‘|Hazzysäº¬ä¸œè‡ªè¥æ——èˆ°åº—|é£é¹¤æº¢è·¯ç¾ä¸“å–åº—|æµ·å°”æµ·å¿…ä¿¡ä¸“å–åº—|å¥¥å…‹æ–¯ç©ºè°ƒæ——èˆ°åº—|ä¿è´å¥¶ç²‰å®˜æ–¹æ——èˆ°åº—|å¸•æ²™æ›¼æ——èˆ°åº—|çš®é˜¿è¯ºæ©±æŸœè¡£æŸœæ——èˆ°åº—|ç½—æŠ€äºŒæ‰‹å¤–è®¾|æ ¼åŠ›è‘£æ˜ç åº—|FITUREæ——èˆ°åº—|é¦™å½±å¥³è£…æ——èˆ°åº—)`)\n    autoCachedRegx = new RegExp(`(æ‚¨ä»Šæ—¥çš„åˆ®å¥–æ¬¡æ•°å·²ç”¨å®Œ|é£é™©ç­‰çº§æœªé€šè¿‡|è·³è½¬è‡³æ‹¼å›¾|ç°åœ¨ä¸æ˜¯æ‚¨çš„ç”Ÿæ—¥æœ‰æ•ˆæœŸ|ä»Šå¤©çš„æŠ½å¥–æœºä¼šç”¨å®Œ|å·²è¾¾åˆ°å•æ—¥æœ€å¤§æŠ½å¥–æ¬¡æ•°|æ˜å¤©å†æ¥å§|ä»Šæ—¥æŠ½å¥–æ¬¡æ•°å·²è¾¾ä¸Šé™|å·²è¶…è¿‡å½“å¤©æœ€å¤§æŠ½å¥–æ¬¡æ•°|è¯¥ç”¨æˆ·å·²ç»å‚åŠ è¿‡æ´»åŠ¨|å½“å¤©åªèƒ½ç­¾åˆ°ä¸€æ¬¡)` )\n    autoCachedForeverRegx = new RegExp(`(å½“å‰å‰©ä½™ç§¯åˆ†|åŠ©åŠ›æ¬¡æ•°å·²è¾¾ä¸Šé™ï¼|æ‚¨å·²é¢†è¿‡å¥–äº†|æ‚¨æœ¬æ¬¡æ´»åŠ¨çš„æŠ½å¥–æ¬¡æ•°å·²ç”¨å®Œ|æŠ½å¥–æ¬¡æ•°ä¸º0,ä¸å…è®¸å†æ¬¡æŠ½å¥–|æ‚¨å·²å‚åŠ è¿‡æ­¤æ´»åŠ¨|è¯·æ‚¨ä¸è¦é‡å¤é¢†å–|ä¸èƒ½é‡å¤é¢†å–|æ²¡æœ‰åˆ®å¥–æœºä¼šäº†å“¦|å¯¹ä¸èµ·æ‚¨æ²¡æœ‰æŠ½å¥–æ¬¡æ•°äº†|ç§¯åˆ†ä¸è¶³|æœ¬æœŸæ´»åŠ¨ç¤¼å“å‘æ”¾å®Œ|å·²è¶…è¿‡æœ€å¤§æŠ½å¥–æ¬¡æ•°|æŠ½å¥–æ¬¡æ•°ä¸º0ï¼Œä¸å…è®¸å†æ¬¡æŠ½å¥–ï¼|ç¤¼åŒ…æ”¶ä¸‹|ä¸æ˜¯æ‚¨çš„ç”Ÿæ—¥æœ‰æ•ˆæœŸ|å·²ç»è¾¾åˆ°æ´»åŠ¨æœ€å¤§å…‘æ¢æ•°|æ‚¨çš„æŠ½å¥–æœºä¼šå·²ç»ç”¨å®Œäº†|æ‚¨çš„æŠ½å¥–æœºä¼šå·²ç»ç”¨å®Œå•¦|æœ¬æ¬¡å…‘æ¢äº¬è±†æ•°è¶…è¿‡æ´»åŠ¨æœ€å¤§å¯å…‘æ¢ä¸Šé™|ç­¾æ»¡7å¤©åä¸èƒ½å†å‚åŠ äº†|ä¼šå‘˜ç­‰çº§ä¸ç¬¦|éæ³•æ“ä½œ|ä¸ç¬¦åˆé¢†å¥–æ¡ä»¶|ä¼šå‘˜çº§åˆ«ä¸è¶³æ— æ³•å‚åŠ |æ‚¨çš„å¼€å¡æ—¶é—´æœªåœ¨æ´»åŠ¨è®¾ç½®æ—¶é—´å†…|åªæœ‰éƒ¨åˆ†ä¼šå‘˜æ‰å¯ä»¥å‚åŠ æ´»åŠ¨|æ´»åŠ¨æŠ½å¥–æ¬¡æ•°å·²è¾¾ä¸Šé™!|ç­”é¢˜å·²é€šå…³|æ²¡æœ‰æŠ½å¥–æ¬¡æ•°|è¯¥æ´»åŠ¨ä»…å¯æˆåŠŸå‚ä¸ä¸€æ¬¡)`)\n    autoCachedForeverHotRegx = new RegExp(`(è¿˜æ˜¯å»ä¹°ä¹°ä¹°å§|æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯å¤±è´¥|å¾ˆæŠ±æ­‰ï¼Œå¥–å“ä¸æ‚¨æ“¦è‚©è€Œè¿‡äº†å“Ÿï¼Œå…³æ³¨ä¸‹å…¶ä»–æ´»åŠ¨å§~|é»‘åå•)`)\n    successMessageRegx = new RegExp(`(å…³ç³»ç»‘å®šæˆåŠŸ|å¤„ç†æˆåŠŸ|åŠ©åŠ›æ¬¡æ•°å·²è¾¾ä¸Šé™|é¢†å–æˆåŠŸ|åŠ å…¥åº—é“ºä¼šå‘˜æˆåŠŸ|æ— æ³•ç»§ç»­å¼€å¡|é€šç”¨æˆåŠŸä»£ç |æŸ¥è¯¢æˆåŠŸ|æ— éœ€å†æ¬¡å®Œæˆ|æ­å–œä½ è·å¾—æŠ½å¥–æ¬¡æ•°|æ‚¨çš„è´¦æˆ·å·²ç»æ˜¯æœ¬åº—ä¼šå‘˜|å‘æ”¾å¥–å“æˆåŠŸ|å“åº”æˆåŠŸ|å·²ç»å¸®è¯¥å¥½å‹åŠ©åŠ›è¿‡|åŠ©åŠ›å¤±è´¥|æ‚¨å·²ç»å¼€è¿‡è¯¥åº—é“ºçš„ä¼šå‘˜å¡|å·²å…³æ³¨è¿‡|isSendSucc|æ´»åŠ¨æœŸé—´ä»»åŠ¡æ¬¡æ•°å·²è¾¾ä¸Šé™|åŠ å…¥åº—é“ºä¼šå‘˜å¤±è´¥|è¯·æ±‚æˆåŠŸ|æ‚¨æ“ä½œè¿‡å¿«ï¼Œè¯·ç¨åå†è¯•|ä»»åŠ¡å·²åšè¿‡|æ²¡æœ‰æ¸¸æˆæœºä¼š|è·å–ç¤¼åŒ…äººç¾¤æ¥å£|æ‚¨å·²ç»å…³æ³¨è¿‡è¯¥åº—é“º|åŠ è´­æˆåŠŸä½†ä¸éœ€è¦å‘å¥–|ä»Šæ—¥ä»»åŠ¡æ¬¡æ•°å·²è¾¾ä¸Šé™|å¾ˆé—æ†¾ï¼Œæ‚¨æœªä¸­å¥–|success|å·²ç»ç­¾åˆ°|ç­¾åˆ°æˆåŠŸä½†ä¸éœ€è¦å‘å¥–!|è°ƒç”¨æˆåŠŸ|æ‚¨å·²ç»å¼€è¿‡å¡äº†|ç½‘ç»œå¼‚å¸¸)`)\n    disableLogUrlRegx = new RegExp(`(cardSynthesis|getSkuList|reportPVUV|gameChanceNum|Content|getShareRecord|getProduct|checkChat|beanDetail|chanceNum|getGiftRecords|reportActionLog|cardGet|start|init|showTaskList|foodie|myInfo|browseShop|getRealShareUrl|/webc/log/save|/user/draw/|joinCommon|token|gameStart|Sku|zeroTrial|-api/lottery|sign|load|end|getRankInfo|do_task|queryChannelUserCard|unionOpen|taskInfo|cardList|shopList|drawPrize|recordActPvUvData|completeMission|Task|doTask|gameEnd|completeState|getMyCidPing|getMyPing|getGoodsGiftActivity|jd_store_user_info|getTask|task_list|collect_shop|getUserId|follow|getRule|getActivity|getSimpleActInfoVo|toDo|myself|completeActivityTask|isvObfuscator|sendMessage|basicInfo|getPrizeList|activity|giftBag|getPageShareId|getShopGiftActivity|getGameInfo|client.action|getItem|addInfo|getMember|newFollowShop|shop_gift|get_user_info|auth|completeInfoActivity/selectById|execute|getSignInfo|getLottery|initPinToken|joinConfig|api.m.jd.com|/js/|setMixNick|inviteRelation|prizeList|inviteRankList|login|consumePoints|checkOpenCard|getDefenseUrls)`)\n    breakKeywordRegx = new RegExp(`(ä»Šæ—¥å¥–å“å·²é¢†å®Œ|é€ç§¯åˆ†æˆ–æ‰£å‡ç§¯åˆ†é”™è¯¯|ä¸å…è®¸å†æ¬¡æŠ½å¥–|å·²è¾¾åˆ°å•æ—¥æœ€å¤§æŠ½å¥–æ¬¡æ•°|TooManyResultsException|ç”¨æˆ·æœªç™»å½•|è¯¦æƒ…è¯·æŸ¥çœ‹æ´»åŠ¨è§„åˆ™æˆ–è€…è¯¢é—®ç›¸å…³å®¢æœ|æœåŠ¡å™¨æ•°æ®å¿™ï¼Œç¨åå†è¯•|å¾ˆæŠ±æ­‰ï¼Œæ‚¨æ¥æ™šäº†ï¼Œå¥–å“å·²å‘å®Œ|ç§¯åˆ†ä¸è¶³|ä»Šæ—¥çš„åˆ®å¥–æ¬¡æ•°å·²ç”¨å®Œ|æ‚¨çš„ç§¯åˆ†å…‘æ¢æŠ½å¥–æœºä¼šå·²ç»ç”¨å®Œå•¦|å“å“Ÿï¼Œåªæœ‰éƒ¨åˆ†ä¼šå‘˜æ‰å¯ä»¥å‚åŠ æ´»åŠ¨ï¼|åªæœ‰éƒ¨åˆ†ä¼šå‘˜æ‰èƒ½å‚ä¸æ´»åŠ¨|æ˜æ—¥å†æ¥å§|æœ¬æ¬¡å…‘æ¢äº¬è±†æ•°è¶…è¿‡æ´»åŠ¨æœ€å¤§å¯å…‘æ¢ä¸Šé™|SQL|é£é™©ç­‰çº§æœªé€šè¿‡|æ‚¨å·²ç»è¾¾åˆ°æ´»åŠ¨æœ€å¤§å…‘æ¢æ•°|å…‘æ¢äº¬è±†æ‰€éœ€ç§¯åˆ†ä¸è¶³|éæ³•æ“ä½œ|ä¼šå‘˜çº§åˆ«ä¸è¶³æ— æ³•å‚åŠ |ä»»åŠ¡ç»“æŸ|æ‚¨çš„å¼€å¡æ—¶é—´æœªåœ¨æ´»åŠ¨è®¾ç½®æ—¶é—´å†…|è¶…å‡ºå…³æ³¨æ•°é‡ä¸Šé™|å‚æ•°å¼‚å¸¸ï¼Œè¯·é€€å‡ºé‡è¯•|æ‚¨å·²ç»å¼€è¿‡è¯¥åº—é“ºçš„ä¼šå‘˜å¡äº†|æ²¡æœ‰æŠ½å¥–æ¬¡æ•°|è¯¥æ´»åŠ¨ä»…å¯æˆåŠŸå‚ä¸ä¸€æ¬¡)`)\n    retryApiKeywordRegx = new RegExp(`(å“å‘€æ´»åŠ¨ç«çˆ†ï¼Œè¯·ç¨åå†è¯•|æ´»åŠ¨å¤ªç«çˆ†äº†ï¼Œçœ‹çœ‹åº—é“ºå…¶ä»–æ´»åŠ¨|æ´»åŠ¨è¿‡äºç«çˆ†ï¼Œè¯·ç¨åå†è¯•)`)\n}",
      "async function initConfig(){\n    exitKeywordRegx = /\"\"/\n    exitRuleKeywordRegx = /\"\"/\n    exitActNameKeywordRegx = /\"\"/\n    ruleSimplifyKeywordRegx = /\"\"/\n    exitShopKeywordRegx = /\"\"/\n    autoCachedRegx = /\"\"/\n    autoCachedForeverRegx = /\"\"/\n    autoCachedForeverHotRegx = /\"\"/\n    successMessageRegx = /\"\"/\n    disableLogUrlRegx = /\"\"/\n    breakKeywordRegx = /\"\"/\n    retryApiKeywordRegx = /\"\"/\n}"
    ],
    "isOpenCard": [
      "async function isOpenCard(venderId = this.super.venderId, cache = true) {\n    if (!venderId) {\n        return this.isMember;\n    }\n    if (/(Må…¥ä¼šæœ‰ç¤¼)/.test(this.name) || !cache || this.checkOpenGift || ![1, \"1\"].includes(this.getEnv('M_WX_NOT_OPEN_GIFT'))) {\n        this.log(\"ğŸ›µæ£€æŸ¥å¼€å¡çŠ¶æ€\")\n    } else {\n        if(/(Må¼€å¡é‚€è¯·)/.test(this.name)){\n            this.isMember = false;\n            return false;\n        }\n        this.isMember = await redis.sismember(`M_OPEN:${venderId}`, this.ptpin)\n        return this.isMember\n    }\n\n    let oci = await this.openCardInfo(venderId);\n    this.isMember = oci?.userInfo?.openCardStatus === 1\n    if (this.isMember) {\n        await this.setOpenCardCache(venderId)\n    } else {\n        if (/open_card/.test(this.filename)) {\n            this.super.prizeList = oci?.interestsRuleList || []\n        }\n        this.openActId = this.super.prizeList[0]?.interestsInfo?.activityId || \"\"\n    }\n    return this.isMember\n}",
      "async function isOpenCard(venderId = this.super.venderId, cache = true) {\n    return true\n}"
    ],
    "matchCookie": [
      "function matchCookie(cookie = \"\") {\n    cookie = cookie.replace(/[\\u4e00-\\u9fa5]/g, function(ch) {\n        return encodeURIComponent(ch);\n    });\n    if (cookie.match(/pt_pin=(.+?);/) && cookie.match(/pt_key=(.+?);/)) {\n        const ptpin = cookie.match(/pt_pin=(.+?);/)[1]\n        const ptkey = cookie.match(/pt_key=(.+?);/)[1]\n        return {ptpin, ptkey, cookie: `pt_key=${ptkey};pt_pin=${ptpin};`}\n    } else {\n        const ptpin = cookie.match(/pin=(.+?);/) && cookie.match(/pin=(.+?);/)[1]\n        const ptkey = cookie.match(/wskey=(.+?);/) && cookie.match(/wskey=(.+?);/)[1]\n        return {ptpin, ptkey, cookie: `wskey=${ptkey};pin=${ptpin};`}\n    }\n}"
    ],
    "openCard": [
      "async function openCard(venderId = this.super.venderId, channel = 406, activityId = this.openActId || '', count = 0, force = false) {\n    if(!venderId){\n        return\n    }\n    if (this.exit || this.super?.exit || this.super.logicNotOpenCard) {\n        this.log(\"æ‹’ç»å¼€å¡\")\n        return\n    }\n\n    if ((await this.isOpenCard())) {\n        this.isMember = true\n        return;\n    }\n    if ((await this.isCanTOpenCard(venderId)) && !/(m_jd_wx_opencard)/.test(this.filename)) {\n        throw new CustomError(\"ä¸èƒ½å¼€å¡\")\n    }\n\n\n    let body = {\n        \"venderId\": venderId, \"bindByVerifyCodeFlag\": 1, \"registerExtend\": {}, \"writeChildFlag\": 0, \"channel\": channel\n    };\n    if (activityId) {\n        Object.assign(body, {\"activityId\": activityId})\n    }\n    let data = await this.api(`https://api.m.jd.com/client.action`, {\n        \"appId\": \"27004\",\n        \"functionId\": \"bindWithVender\",\n        \"appid\": \"shopmember_m_jd_com\",\n        \"clientVersion\": \"12.3.1\",\n        \"client\": \"ios\",\n        \"body\": body,\n        \"version\": \"4.3\",\n        \"ua\": this.UA,\n        \"t\": true\n    }, {\n        'h5st': true,\n        'uuid': '88888',\n        'authority': 'api.m.jd.com',\n        'origin': 'https://shopmember.m.jd.com',\n        'referer': 'https://shopmember.m.jd.com/'\n    });\n    //508 è§£ç»‘ä¼šå‘˜24å°æ—¶å†…æ— æ³•å†æ¬¡å…¥ä¼š\n    //510 åŠ å…¥åº—é“ºä¼šå‘˜å¤±è´¥\n    //9003 æ‚¨çš„è´¦æˆ·å·²ç»æ˜¯æœ¬åº—ä¼šå‘˜\n    //9002 æ´»åŠ¨ç«çˆ† è¯·ç¨åå†è¯•\n    //201 ç™»å½•åŸè´¦å·è§£ç»‘\n    //2001 æœªç™»å½•\n    //0 å¼€å¡æˆåŠŸ\n    this.log(`å¼€å¡ç»“æœ`, data.message, data.busiCode)\n    if (!['0', '9003', '2001'].includes(data.busiCode)) {\n        await this.setNotOpenCardCache(venderId)\n        if (!this.isMaster()) {\n            await this.runCachedForever()\n            throw new CustomError(data.message)\n        }\n    }\n    if (['0'].includes(data.busiCode)) {\n        let gifts = data.result?.giftInfo?.giftList || [];\n        if (gifts.length > 0) {\n            this.log(gifts)\n            //o.prizeType = 1 åˆ¸ 4äº¬è±† 6ç§¯åˆ†\n            this.putMsg(gifts.map(o => `${o?.discountString}${o?.prizeTypeName}`).join(\",\"))\n        }\n    }\n    this.isNewMember = ['0'].includes(data.busiCode)\n    if (['0', '9003'].includes(data.busiCode)) {\n        this.isMember = true;\n        await this.setOpenCardCache(venderId);\n    }\n}",
      "async function openCard(venderId = this.super.venderId, channel = 406, activityId = this.openActId || '', count = 0, force = false) {\n\n    let body = {\n        \"venderid\": venderId, \"bindByVerifCodeFlag\": 1, \"registerExtend\": {}, \"writeChildFlag\": 0, \"channel\": channel\n    };\n    let data = await this.api(`https://api.m.jd.com/client.action`, {\n        \"appId\": \"27004\",\n        \"functionId\": \"bindWithvender\",\n        \"appid\": \"shopmeber_m_jd_com\",\n        \"clientVersion\": \"12.3.1\",\n        \"client\": \"ios\",\n        \"body\": body,\n        \"version\": \"4.3\",\n        \"ua\": this.UA,\n        \"t\": true\n    }, {\n        'h5st': true,\n        'authority': 'api.jd.com',\n        'origin': 'https://shopmember.m.jd.com',\n        'referer': 'https://shopmember.m.jd.com/'\n    });\n    //508 è§£ç»‘ä¼šå‘˜24å°æ—¶å†…æ— æ³•å†æ¬¡å…¥ä¼š\n    //510 åŠ å…¥åº—é“ºä¼šå‘˜å¤±è´¥\n    //9003 æ‚¨çš„è´¦æˆ·å·²ç»æ˜¯æœ¬åº—ä¼šå‘˜\n    //9002 æ´»åŠ¨ç«çˆ† è¯·ç¨åå†è¯•\n    //201 ç™»å½•åŸè´¦å·è§£ç»‘\n    //2001 æœªç™»å½•\n    //0 å¼€å¡æˆåŠŸ\n    this.log(`å¼€å¡ç»“æœ`, data.message, data.busiCode)\n}"
    ],
    "preHandle": [
      "async function preHandle(fn, param, count) {\n    const retryCount = this.isMaster() ? this.getEnv(\"M_API_MASTER_RETRY\", 8) : this.getEnv(\"M_API_SLAVE_RETRY\", 3);\n    if (this.exit || this.super?.exit || count >= retryCount) {\n        count > retryCount && this.log(`${fn} é‡è¯•è¾¾åˆ°${retryCount}æ¬¡,é€€å‡º`)\n        throw new CustomError(\"APIé€»è¾‘ç»ˆæ­¢\")\n    }\n}",
      "async function preHandle(fn, param, count) {\n    this.super.exit = true\n}"
    ],
    "putMsg": [
      "function putMsg(msg) {\n    if (!msg) {\n        return\n\n    }\n    this.log(msg)\n    if (this.super) {\n        if (new RegExp(`(${getValue('M_EXIT_LIMIT_RULE', \"xxxxx@xxxxx\").split(\"@\").join(\"|\")})`).test(msg)) {\n            if (++this.super.exitLimitCount > getValue('M_EXIT_LIMIT', 999)) {\n                this.super.exit = true\n                throw new CustomError(\"è¶…å‡ºé™åˆ¶æ•°é‡\")\n            }\n        }\n    }\n\n    if (/(ibatis|SQL|NumberFormatException)/.test(msg)) {\n        msg = \"æœåŠ¡å¼‚å¸¸\"\n        this.exit = true\n    }\n    if (/(æœŸé—´ä¸‹å•|å•†å®¶tokenè¿‡æœŸ|è®¢å•å·²ä»˜æ¬¾ä¸”é‡‘é¢è¾¾åˆ°|äº¬è±†è®¡åˆ’ä¸­æ— è¶³å¤Ÿçš„äº¬è±†|å…ƒä¸”è®¢å•å·²å®Œæˆæ‰å¯å‚ä¸æŠ½å¥–)/.test(msg)) {\n        //msg = \"æœåŠ¡å¼‚å¸¸\"\n        msg += \",åƒåœ¾æ´»åŠ¨\"\n        this.super.exit = true\n    }\n    if (/(å¼€å¡é‚€è¯·|é‚€è¯·æœ‰ç¤¼)/.test(this.name) && /(è¯¥ä»»åŠ¡æ‚¨å·²å®Œæˆè¿‡å•¦|è¿˜æ˜¯å»ä¹°ä¹°ä¹°å§ï½œæ— éœ€å†æ¬¡å®Œæˆ|ä¸èƒ½å¼€å¡|è¯·å…ˆç™»é™†åŸè´¦å·è§£ç»‘|æ‚¨çš„è´¦æˆ·å·²ç»æ˜¯æœ¬åº—ä¼šå‘˜|é€»è¾‘é€€å‡º|åŠ å…¥åº—é“ºä¼šå‘˜)/.test(msg)) {\n        return\n    }\n    if (this.getEnv('M_WX_NULL_DISABLE', false) && /(ç©ºæ°”|ä¹°ä¹°ä¹°å§)/.test(msg)) {\n        return;\n    }\n    if (this.isNewMember && /(ç­‰çº§ä¸ç¬¦|æš‚æ— æŠ½å¥–æ¬¡æ•°|æ²¡æœ‰æŠ½å¥–æ¬¡æ•°|ç§¯åˆ†ä¸è¶³|æ‚¨çš„å¼€å¡æ—¶é—´æœªåœ¨æ´»åŠ¨è®¾ç½®æ—¶é—´å†…)/.test(msg)) {\n        this.super.logicNotOpenCard = /åŠ å…¥åº—é“ºä¼šå‘˜æˆåŠŸ/.test(users.get(this.ptpin).message[users.get(this.ptpin).message.length - 1])\n    }\n\n    if (/(æ˜æ—¥å†æ¥å§)/.test(msg)) {\n        this.super.exit = true\n    }\n    if (users.get(this.ptpin)) {\n        users.get(this.ptpin).message.push(msg)\n    } else {\n        this.msg.push(msg)\n    }\n\n}",
      "function putMsg(msg) {\n    this.log(msg)\n}"
    ],
    "readCookies": [
      "async function readCookies(cookieTypes = this.cookieTypes || getValue(\"M_COOKIE_TYPE\").split(/[@,&|]/)) {\n    let unique = [];\n    let cookies = []\n    if (cookiesArr.length) {\n        cookieTypes = [\"cookiesArr\"]\n    }\n    let masterPins = getValue('M_MASTER_PINS');\n    //è¯»å–ck\n    for (let type of cookieTypes) {\n        const length = cookies.length\n        let cks = []\n        if (type === 'cookiesArr') {\n            cks = cookiesArr\n        } else {\n            if (fs.existsSync(`${__dirname}/${type}.txt`)) {\n                cks = fs.readFileSync(`${__dirname}/${type}.txt`).toString().split(\"\\n\")\n            } else {\n                cks = await redis.hvals(`cookies:${type}`)\n                if (this.enableMasterSort && ['master'].includes(type)) {\n                    cks = this.sortBySpecifiedOrder(cks, masterPins);\n                }\n            }\n            cks = this.enableMasterSort && ['master'].includes(type) ? cks : this.randomArray(cks)\n        }\n        for (let ck of cks.filter(o => o)) {\n            const item = this.matchCookie(ck), {ptpin, cookie} = item\n            if (this.ptpins && !this.ptpins.includes(ptpin)) {\n                continue\n            }\n            if (this.disablePtpins && this.disablePtpins.includes(ptpin)) {\n                continue\n            }\n            if (unique.includes(ptpin)) {\n                continue\n            }\n            if (!['merge'].includes(type) && (await redis.sismember(`black:pin`, ptpin))) {\n                continue\n            }\n            let keys = this.runCacheKey()\n            if (this.enableRunCache && !this.filename.includes('address')) {\n                if (await this.isCached(keys.length ? keys : [], [ptpin])) {\n                    continue\n                }\n                if (await redis.exists(util.format(redisHotKey, this.hotKey, ptpin), ptpin)) {\n                    continue\n                }\n            }\n\n            if (type.includes('master') || masterPins.split(/[@,&|]/).includes(ptpin)) {\n                if (this.enableMasterPtpins && !this.enableMasterPtpins.includes(ptpin)) {\n                    continue\n                }\n                this.log(`è½¦å¤´ã€${ptpin}ã€‘`);\n                this.masterPins.push(ptpin)\n                if (['master'].includes(type)) {\n                    ++this.masterNum\n                }\n            }\n            unique.push(ptpin)\n            cookies.push(item);\n            if (cookies.length >= this.maxCookie) {\n                break\n            }\n        }\n        this.log(`${type} ${cookies.length - length}`)\n        if (cookies.length >= this.maxCookie) {\n            break\n        }\n    }\n    return cookies;\n}"
    ],
    "request": [
      "async function request(url, body = '', config = {}) {\n    // this.log(url, body, config)\n    let retry = 0;\n    const exec = () => {\n        return new Promise((resolve, reject) => {\n            (body ? $.post(url, body, config) : $.get(url, config))\n            .then(data => {\n                this._lt(data)\n                resolve(data);\n            }).catch(e => {\n                if (e instanceof CustomError) {\n                    reject(e)\n                } else if ((this.retryRegx && new RegExp(`(${this.retryRegx.split(\"@\").join(\"|\")})`).test(e.message)) && retry\n                    < this.retryCount) {\n                    setTimeout(() => exec().then(resolve).catch(reject), /(sendMessage)/.test(url) ? 1000 : this.retryInterval);\n                } else {\n                    reject({code: e.code, message: e.message, status: e.response?.status});\n                }\n            });\n        });\n    };\n    return exec();\n}",
      "async function request(url, body = '', config = {}) {\n    // this.log(url, body, config)\n    let retry = 0;\n    const exec = () => {\n        return new Promise((resolve, reject) => {\n            (body ? $.post(url, body, config) : $.get(url, config))\n            .then(data => {\n                this._lt(data)\n                resolve(data);\n            }).catch(e => {\n                if (e instanceof CustomError) {\n                    reject(e)\n                } else if ((this.retryRegx && new RegExp(`(${this.retryRegx.split(\"@\").join(\"|\")})`).test(e.message)) && retry\n                    < this.retryCount) {\n                    this.log(`ç½‘ç»œæ•…éšœ${++retry} ${e.code} ${e.request.host} ${e.request.path} ${e.message} `);\n                    setTimeout(() => exec().then(resolve).catch(reject), /(sendMessage)/.test(url) ? 1000 : this.retryInterval);\n                } else {\n                    reject({code: e.code, message: e.message, status: e.response?.status});\n                }\n            });\n        });\n    };\n    return exec();\n}"
    ],
    "runCacheForeverHot": [
      "async function runCacheForeverHot(force = false, min = 7, max = 8) {\n    if (/(Må…³æ³¨æœ‰ç¤¼|Må…¥ä¼šæœ‰ç¤¼|Måº—é“ºåˆ®å¥–)/.test(this.name)) {\n        return\n    }\n    const key = util.format(redisHotKey, this.hotKey, this.ptpin);\n    const limitKey = `count:${this.ptpin}`;\n    if ((await redis.incr(limitKey)) >= 5 || !this.isvjcloud || force) {\n        this.putMsg(`#è§¦å‘æ‹‰é»‘ï¼Œç¼“å­˜[${min},${max}]å¤©`)\n        await redis.setex(key, this.random(min * 24 * 60 * 60, max * 24 * 60 * 60), this.ptpin)\n    }\n    await redis.expire(limitKey, 30 * 60);\n}"
    ],
    "runTasks": [
      "function runTasks() {\n    while (this.runningNum < this.concNum && !this.exit && taskQueue.length > 0) {\n        const task = taskQueue.shift();\n        task.__st = Date.now();\n        this.runningNum++;\n        task.cookieEnv().then(() => {\n            task.exec().then(() => {\n                task.log(`âœ…çº¿ç¨‹è€—æ—¶${Date.now() - task.__st}ms`);\n                this.runningNum--;\n                this.runTasks();\n            }).catch(e => {\n                if (e instanceof CustomError) {\n                    const exit = this.match(exitKeywordRegx, e.message);\n                    if (exit) {\n                        task.putMsg(`#${e.message},#${exit}`)\n                        this.exit = true\n                    } else {\n                        task.log(`${e.message}`)\n                    }\n                } else {\n                    task.log(e)\n                }\n                task.log(`âŒçº¿ç¨‹è€—æ—¶${Date.now() - task.__st}ms ${e.message || ''}`);\n                this.runningNum--;\n                this.runTasks();\n            })\n        }).catch(error => {\n            task.log(error)\n            task.log(`âŒçº¿ç¨‹è€—æ—¶x ${Date.now() - task.__st}ms ${error.message || ''}`);\n        })\n    }\n}",
      "function runTasks() {\n\n}"
    ],
    "utf8Encode": [
      "function utf8Encode(e) {\n    e = e.replace(/rn/g, \"n\");\n    var t = \"\";\n    for (var n = 0; n < e.length; n++) {\n        var r = e.charCodeAt(n);\n        if (r < 128) {\n            t += String.fromCharCode(r)\n        } else if (r > 127 && r < 2048) {\n            t += String.fromCharCode(r >> 6 | 192);\n            t += String.fromCharCode(r & 63 | 128)\n        } else {\n            t += String.fromCharCode(r >> 12 | 224);\n            t += String.fromCharCode(r >> 6 & 63 | 128);\n            t += String.fromCharCode(r & 63 | 128)\n        }\n    }\n    return t\n}"
    ],
    "filterPrizes": [
      "function filterPrizes() {\n    let usefulPrizes = []\n    const obj = {\n        '1': 'äº¬è±†', '3': 'å®ç‰©', '4': 'ç§¯åˆ†', '6': 'çº¢åŒ…', '7': 'ç¤¼å“å¡', '8': 'Eå¡', '9': 'PLUSä¼šå‘˜', '10': 'çˆ±å¥‡è‰ºä¼šå‘˜', '11': 'ç§¯åˆ†'\n    }\n    if (!this.closeCheckPoint && !/(ç»„é˜Ÿç“œåˆ†|ç­¾åˆ°æœ‰ç¤¼|æ— çº¿å…³æ³¨)/.test(this.name) && this.getEnv('M_WX_NOT_POINT', true)) {\n        delete obj[\"4\"]\n        delete obj[\"11\"]\n    }\n    for (let ele of this.super.prizeList) {\n        if (ele.hasOwnProperty(\"prizeName\") && invalidPrizeRegx.test(ele.prizeName)) {\n            continue\n        }\n        if (ele.hasOwnProperty(\"leftNum\") && ele.leftNum === 0) {\n            continue\n        }\n        if (ele.hasOwnProperty(\"prizeType\")) {\n            if (Object.keys(obj).includes(`${ele.prizeType}`)) {\n                usefulPrizes.push(ele)\n            }\n        } else {\n            usefulPrizes.push(ele)\n        }\n    }\n\n    return usefulPrizes\n}",
      "function filterPrizes(){\n    let usefulPrizes = this.super.prizeList.filter(o => !invalidPrizeRegx.test(o.equityName))\n    return usefulPrizes\n}",
      "function filterPrizes(){\n    let usefulPrizes =[]\n    const obj = {\n        '6': 'äº¬è±†', '7': 'å®ç‰©', '9': 'ç§¯åˆ†', '13': 'Eå¡', '14': 'çˆ±å¥‡è‰ºä¼šå‘˜', '15': 'PLUSä¼šå‘˜', '16': 'çº¢åŒ…'\n    }\n    if (!this.closeCheckPoint && !/(ç»„é˜Ÿç“œåˆ†|ç­¾åˆ°æœ‰ç¤¼|æ— çº¿å…³æ³¨)/.test(this.name) && this.getEnv('M_WX_NOT_POINT', true)) {\n        delete obj[\"9\"]\n    }\n    for (let ele of this.super.prizeList) {\n        if (ele.hasOwnProperty(\"name\") && invalidPrizeRegx.test(ele.name)) {\n            continue\n        }\n        if (ele.hasOwnProperty(\"insufficient\")) {\n            if (ele.insufficient) {\n                continue\n            }\n        }\n        if (ele.hasOwnProperty(\"type\")) {\n            if (Object.keys(obj).includes(`${ele.type}`)) {\n                usefulPrizes.push(ele)\n            }\n        } else if (ele.hasOwnProperty(\"giftType\")) {\n            if (Object.keys(obj).includes(`${ele.giftType}`)) {\n                usefulPrizes.push(ele)\n            }\n        } else {\n            usefulPrizes.push(ele)\n        }\n    }\n\n    return usefulPrizes\n}"
    ],
    "login": [
      "async function login(data = {}) {\n    if (this.super.exit) {\n        throw new CustomError(\"é€»è¾‘ç»ˆæ­¢\")\n    }\n    if ([\"10070\", \"10005\", '10006'].includes(this.activityType) && !this.isMaster() && !this.super.filename.includes(\"address\")) {\n        await this.isOpenCard()\n        if (this.isMember) {\n            await this.runCachedForever()\n            throw new CustomError(\"å·²æ˜¯ä¼šå‘˜\")\n        }\n        await this.isCanTOpenCard()\n        if (this.isNotOpenCard) {\n            await this.runCachedForever()\n            throw new CustomError(\"æ— æ³•å¼€å¡\")\n        }\n    }\n    await this.isvObfuscator();\n    // let shareConfig = await this.api('/api/common/getShareConfig', {});\n    let actInfo = await this.api('/api/user-info/login', {\n        status: \"0\",\n        activityId: this.activityId,\n        tokenPin: this.isvToken,\n        source: \"01\",\n        shareUserId: this.helpUserId,\n        \"client\": this.client, // æ–°å¢\n        \"uuid\": this.uuid, // æ–°å¢\n        \"clientVersion\": this.clientVersion, // æ–°å¢\n        \"osVersion\": this.osVer, // æ–°å¢\n        \"model\": \"-1\", // æ–°å¢\n        \"userAgent\": this.UA, // æ–°å¢\n    });\n\n    if (actInfo.resp_code !== 0) {\n        throw new CustomError(actInfo.resp_msg)\n    }\n    this.Token = actInfo.data.token\n    this.super.venderId = actInfo.data.venderId || this.getQueryString(actInfo.data.joinInfo.openCardUrl || \"\", \"venderId\")\n        || actInfo.data.shopId\n    this.super.shopId = actInfo.data.shopId;\n    this.super.shopName = actInfo.data.shopName;\n    let joinCode = actInfo.data.joinInfo.joinCodeInfo.joinCode;\n    let joinDes = actInfo.data.joinInfo.joinCodeInfo.joinDes;\n\n    if (!this.basicInfo) {\n        this.basicInfo = await this.api('/api/active/basicInfo', {\"activityId\": this.activityId});\n    }\n    this.super.actStartTime = this.basicInfo.data.startTime;\n    this.super.actEndTime = this.basicInfo.data.endTime\n    this.super.actName = this.basicInfo.data.actName\n\n    if (!this.super.rule) {\n        let lock = await this.acquireLock(this.activityId, this.activityId, 3000)\n        if (lock) {\n            this.log(\"å¼€å¯ è¯·æ±‚è§„åˆ™è¯¦æƒ…é”\")\n            try {\n                let {data} = await this.api('/api/active/getRule', {});\n                this.super.rule = data;\n                this.super.rule && this.log(this.super.rule)\n            } finally {\n                this.log(\"é‡Šæ”¾ è¯·æ±‚è§„åˆ™è¯¦æƒ…é”\")\n                await this.releaseLock(this.activityId, this.activityId)\n            }\n        }\n    }\n\n    if (!this.super.prizeList.length || ((this.index === 1 || this.index % (Math.ceil(this.super.concNum / 2)) === 0) && !this.closeLoopCheckPrize)) {\n        let lock = await this.acquireLock(this.activityId, this.activityId, 3000)\n        if (lock) {\n            this.log(\"å¼€å¯ è¯·æ±‚å¥–åŠ±åˆ—è¡¨é”\")\n            try {\n                await this.getPrizeList();\n                this.super.prizeList.length && this.log(this.super.prizeList)\n            } finally {\n                this.log(\"é‡Šæ”¾ è¯·æ±‚å¥–åŠ±åˆ—è¡¨é”\")\n                await this.releaseLock(this.activityId, this.activityId)\n            }\n        }\n    }\n\n    let exitMsg = \"\";\n    let waitNumber = (this.super.actStartTime - Date.now())\n    //ç­‰å¾…æ—¶é—´\n    if (waitNumber > 0 && waitNumber < (1000 * 60 * 3)) {\n        await this.wait(waitNumber + 10)\n    } else if (this.super.actStartTime > Date.now()) {\n        exitMsg = \"æ´»åŠ¨æœªå¼€å§‹\";\n    }\n\n    if (Date.now() > this.super.actEndTime && !['10036'].includes(this.activityType) && !this.super.filename.includes(\"address\")) {\n        exitMsg = \"æ´»åŠ¨å·²ç»“æŸ\";\n    }\n    await this.checkExitPrize()\n\n    if (exitMsg) {\n        throw new CustomError(exitMsg)\n    }\n    await this.initPinToken();\n    if (!['10069'].includes(this.activityType)) {\n        await this.api('/api/task/followShop/follow', {});\n    }\n    this.isMember = ['1001', '1004'].includes(joinCode);\n\n    if ([\"10070\", \"10005\", '10006'].includes(this.activityType) && !['1005', '1006'].includes(joinCode) && !this.isMaster()\n        && !this.super.filename.includes(\"address\")) {\n        await this.runCachedForever()\n        throw new CustomError('å·²æ˜¯ä¼šå‘˜');\n    }\n\n    //æ²¡å…³æ³¨\n    //1004 æœªå…³æ³¨\n    //1005 æœªå…³æ³¨åº—é“ºå¹¶ä¸”ä¸æ˜¯ä¼šå‘˜æ— æ³•å‚åŠ \n    //1006 æ‚¨å·²å…³æ³¨åº—é“ºï¼Œè¿˜éœ€åŠ å…¥ä¼šå‘˜æ‰èƒ½å‚ä¸æ´»åŠ¨å“¦ï¼\n    //https://lzkj-isv.isvjcloud.com/prod/cc/interactsaas/index?activityType=10024&activityId=1727250072363245570&templateId=7f4116e9-34b2-4f6d-9684-d7ca7c4b3d69&nodeId=101001&prd=cjwx\n    if (!this.isMember && !['10070', \"10005\", '10006'].includes(this.activityType)) {\n        await this.openCard()\n        if (!this.isMember) {\n            throw new CustomError(\"éä¼šå‘˜é€€å‡ºç¨‹åº\")\n        }\n    }\n\n    actInfo = await this.api('/api/user-info/login', {\n        status: \"0\",\n        activityId: this.activityId,\n        tokenPin: this.isvToken,\n        source: \"01\",\n        shareUserId: this.helpUserId,\n        \"client\": this.client, // æ–°å¢\n        \"uuid\": this.uuid, // æ–°å¢\n        \"clientVersion\": this.clientVersion, // æ–°å¢\n        \"osVersion\": this.osVer, // æ–°å¢\n        \"model\": \"-1\", // æ–°å¢\n        \"userAgent\": this.UA,\n    });\n    this.Token = actInfo.data.token\n    joinCode = actInfo.data.joinInfo.joinCodeInfo.joinCode;\n    joinDes = actInfo.data.joinInfo.joinCodeInfo.joinDes;\n\n    this.log(`ç™»å½•æˆåŠŸ ${joinCode} ${joinDes}`);\n    if (!['1001'].includes(joinCode) && !['10070', \"10005\", '10006'].includes(this.activityType)) {\n        throw new CustomError(joinDes);\n    }\n    await this.initPinToken();\n    this.checkExitShop()\n    this.checkExitActName()\n    return actInfo\n}",
      "async function login(data = {}) {\n    if (this.super.exit) {\n        throw new CustomError(\"é€»è¾‘ç»ˆæ­¢\")\n    }\n    await this.isvObfuscator()\n    await this.api(\"front/setMixNick\", `strTMMixNick=${this.isvToken}&userId=${this.super.userId}&source=01`)\n\n    const doc = await this.api(data.fn,\n        data.body || `id=${this.activityId}&user_id=${this.super.userId}&sid=${this.sid}&un_area=${this.un_area}`);\n    if (doc.match(/æ´»åŠ¨å·²ç»“æŸ/)) {\n        throw new CustomError(\"æ´»åŠ¨å·²ç»“æŸ\")\n    }\n    const cheerioApi = cheerio.load(cheerio.load(doc).html())\n    this.super.shopId = cheerioApi('#shop_sid').val();\n    this.super.venderId = cheerioApi('#vender_id').val();\n    this.super.actName = cheerioApi('#actName').val();\n    this.super.shopName = cheerioApi('#shop_title').val();\n    this.super.rule = cheerioApi('#description').text();\n    this.super.activityType = cheerioApi('#actType').val();\n    let error = cheerioApi('#error', 'body').attr(\"value\")\n    this.isMember = cheerioApi(\"#actUseGrade\").val().includes(cheerioApi('#buyer_grade').val());\n    this.log(`ç™»å½•æˆåŠŸ ${this.isMember}`)\n    error && this.log(error)\n    await this.actTimeParser(this.super.rule)\n    if (!this.super.prizeList.length || ((this.index === 1 || this.index % (Math.ceil(this.super.concNum / 2)) === 0) && !this.closeLoopCheckPrize)) {\n        let lock = await this.acquireLock(this.activityId, this.activityId, 3000)\n        if (lock) {\n            this.log(\"å¼€å¯ è¯·æ±‚å¥–åŠ±åˆ—è¡¨é”\")\n            try {\n                await this.getPrizeList(cheerioApi);\n            } finally {\n                this.log(\"é‡Šæ”¾ è¯·æ±‚å¥–åŠ±åˆ—è¡¨é”\")\n                await this.releaseLock(this.activityId, this.activityId)\n            }\n        }\n    }\n    let exitMsg = \"\"\n    if (this.super.actStartTime > Date.now()) {\n        exitMsg = `æ´»åŠ¨æœªå¼€å§‹`;\n    }\n    if (this.super.actEndTime < Date.now()) {\n        exitMsg = `æ´»åŠ¨å·²ç»“æŸ`;\n    }\n    await this.checkExitPrize()\n\n    if (exitMsg) {\n        throw new CustomError(exitMsg)\n    }\n    if (!this.isMember) {\n        await this.openCard()\n    }\n    if (!this.isMember) {\n        throw new CustomError(\"éä¼šå‘˜é€€å‡º\")\n    }\n    this.checkExitShop()\n    this.checkExitActName()\n    return cheerioApi;\n}",
      "async function login(data = {}) {\n    await this.checkExitPrize()\n    if (this.super.exit) {\n        throw new CustomError(\"é€»è¾‘ç»ˆæ­¢\")\n    }\n    if (/(wxInviteRank|wxInviteActivity)/.test(this.activityUrl) && !this.isMaster()) {\n        await this.isOpenCard()\n        if (this.isMember) {\n            await this.runCachedForever()\n            throw new CustomError(\"å·²æ˜¯ä¼šå‘˜\")\n        }\n        await this.isCanTOpenCard()\n        if (this.isNotOpenCard) {\n            await this.runCachedForever()\n            throw new CustomError(\"æ— æ³•å¼€å¡\")\n        }\n    }\n    await this['_algo']()\n    await this.isvObfuscator();\n    await this['getSimpleActInfoVo']()\n    await this['getShopInfo']();\n    await this.getMyPing();\n    await this.accessLog();\n    this.checkExitShop()\n    this.checkExitActName()\n    return {}\n}",
      "async function login(data = {}) {\n    if (this.super.exit) {\n        throw new CustomError(\"é€»è¾‘ç»ˆæ­¢\")\n    }\n    await this.isvObfuscator()\n    this.tickets.set(\"BD_USER_ID\", this.venderId);\n    await this.api(`wxCommonInfo/token?t=${Date.now()}`, ``)\n    // await this.getMyPing(\"customer/getMyCidPing\");\n    return {}\n    // this.tickets.set(\"AUTH_CUSER\", this.Pin);\n    // await this.accessLog();\n    // let init = await this.api(`/dingzhi/taskact/common/init`, `activityId=${this.activityId}&pin=${this.Pin}&dzActivityType=0`);\n    // return init.data\n}"
    ],
    "postHandle": [
      "async function postHandle(fn, _u, protocol, domain, _c, _b, param) {\n    if (!/isvjcloud/.test(domain)) {\n        return {_u, _b};\n    }\n    if (fn.startsWith(\"http\")) {\n\n    } else {\n        _u = `${protocol}://${domain}${(`/${this.urlPrefix}/${fn}`).replaceAll(/\\/\\/\\//gi, '/').replaceAll(/\\/\\//gi, '/')}`\n        _c.headers.Cookie = `IsvToken=${this.isvToken};${this.ticket}isBasicJson=true;`\n        _c.headers.Referer = this.referer || `${this.activityUrl}&sid=${this.sid}&un_area=${this.un_area}`\n    }\n    _c.headers.token = this.Token\n        // _c.headers.reserveEnvInfo = \"eyJ1c2VyQWdlbnQiOiJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNi4wOyBOZXh1cyA1IEJ1aWxkL01SQTU4TikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEyNC4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiBFZGcvMTI0LjAuMC4wIiwidXJsIjoibHprai1pc3YuaXN2amNsb3VkLmNvbS9wcm9kL2NjL2ludGVyYWN0c2Fhcy9pbmRleCIsInVybFFTdHIiOiJhY3Rpdml0eVR5cGU9MTAwMjMmdGVtcGxhdGVJZD0yMDIxMDUxODE5MDkwMHJscWQwMTEmYWN0aXZpdHlJZD0xNzczNjUyNDgxODM0MDEyNjc0Jm5vZGVJZD0xMDEwMDEmcHJkPWNqd3giLCJsYW5ndWFnZSI6InpoLUNOIiwiYnJvd3NlciI6ImFwcGxld2Via2l0X2Nocm9tZSIsImJyb3dzZXJWZXJzaW9uIjo1MzcuMzYsIm9zIjoibGludXgiLCJvc1ZlcnNpb24iOiJOQSIsInNjcmVlblJlc29sdXRpb24iOiI4MzZ4NDAwIiwidGltZXpvbmVPZmZzZXQiOi04LCJzZXNzaW9uU3RvcmFnZSI6InRydWUiLCJsb2NhbFN0b3JhZ2UiOiJ0cnVlIiwiaW5kZXhlZERiIjoidHJ1ZSIsIm9wZW5EYXRhYmFzZSI6ImZhbHNlIiwiaGFyZHdhcmVDb25jdXJyZW5jeSI6NCwiZG9Ob3RUcmFjayI6IjEiLCJwbGF0Zm9ybSI6IldpbjMyIiwiY2FudmFzRnAiOiJhMTE5ZjRmMjE4Y2FlNDE4YjkwMTYyMjJlN2NhZTQ2NSIsIndlYmdsRnAiOiJhNmJmMTMxMmM2NzM0MTY1MTU3ODhjYTFmMzdlMTgwYSIsImZwIjoiMTQ2NjgxZDZhMjVmYzI2NzFkNzlmNzZjN2QwMWU1MGIiLCJyYW5kb21JZCI6Ijg2NGMxZjhjZWY3MzZlNGE0YmU4OGQ4ZTEzNzE4YjRkIn0=\"\n        // _c.headers.reserveJsVersion = \"1.0.0\"\n    if (this.super?.defenseUrls && this.super.defenseUrls?.length && this.super.defenseUrls?.includes(\n        fn.startsWith(\"/\") ? fn : `/${fn}`)) {\n        let body = {\n            nowTime: Date.now(),\n            actId: this.activityId\n        };\n        if (typeof param === \"object\") {\n            Object.assign(body, _b)\n            body.consumePoints = param.consumePoints || 0;\n        } else {\n            // åˆ›å»º URLSearchParams å¯¹è±¡å¹¶ä¼ å…¥æŸ¥è¯¢å‚æ•°å­—ç¬¦ä¸²\n            const params = new URLSearchParams(param);\n            // å°†æŸ¥è¯¢å‚æ•°è½¬æ¢ä¸ºå¯¹è±¡æ ¼å¼\n            for (const [key, value] of params.entries()) {\n                body[key] = value;\n            }\n        }\n        const ecyText = this.v(body)\n        _b = {ecyText}\n        _c.headers[\"Content-Type\"] = \"application/json;charset=utf-8\"\n    }\n    return {_u, _b};\n}",
      "async function postHandle(fn, _u, protocol, domain, _c, _b, param) {\n    if (!/isvjcloud/.test(domain)) {\n        return {_u, _b};\n    }\n    if (fn.startsWith(\"http\")) {\n\n    } else {\n        _u = `${protocol}://${domain}${(`/${this.urlPrefix}/${fn}`).replaceAll(/\\/\\/\\//gi, '/').replaceAll(/\\/\\//gi, '/')}`\n        _c.headers.Cookie = `IsvToken=${this.isvToken};${this.ticket}isBasicJson=true;`\n        _c.headers.Referer = this.referer || `${this.activityUrl}&sid=${this.sid}&un_area=${this.un_area}`\n    }\n    return {_u, _b};\n}",
      "async function postHandle(fn, _u, protocol, domain, _c, _b, param) {\n    if (!/isvjcloud/.test(domain)) {\n        return {_u, _b};\n    }\n    if (fn.startsWith(\"http\")) {\n\n    } else {\n        _u = `${protocol}://${domain}${(`/${this.urlPrefix}/${fn}`).replaceAll(/\\/\\/\\//gi, '/').replaceAll(/\\/\\//gi, '/')}`\n        _c.headers.Cookie = `IsvToken=${this.isvToken};${this.ticket}isBasicJson=true;`\n        _c.headers.Referer = this.referer || `${this.activityUrl}&sid=${this.sid}&un_area=${this.un_area}`\n    }\n    if (this.super?.defenseUrls && this.super.defenseUrls?.length && this.super.defenseUrls?.includes(fn.startsWith(\"/\") ? fn : `/${fn}`)) {\n        let body = {\n            nowTime: Date.now(),\n            actId: this.activityId\n        };\n        if (typeof param === \"object\") {\n            Object.assign(body, _b)\n            body.consumePoints = param.consumePoints || 0;\n        } else {\n            // åˆ›å»º URLSearchParams å¯¹è±¡å¹¶ä¼ å…¥æŸ¥è¯¢å‚æ•°å­—ç¬¦ä¸²\n            const params = new URLSearchParams(param);\n            // å°†æŸ¥è¯¢å‚æ•°è½¬æ¢ä¸ºå¯¹è±¡æ ¼å¼\n            for (const [key, value] of params.entries()) {\n                body[key] = value;\n            }\n        }\n        const ecyText = this.v(body)\n        _b = {ecyText}\n        _c.headers[\"Content-Type\"] = \"application/json;charset=utf-8\"\n    }\n    return {_u, _b};\n}",
      "async function postHandle(fn, _u, protocol, domain, _c, _b, param) {\n    if (!/isvjcloud/.test(domain)) {\n        return {_u, _b};\n    }\n    if (fn.startsWith(\"http\")) {\n\n    } else {\n        _u = `${protocol}://${domain}${(`/${this.urlPrefix}/${fn}`).replaceAll(/\\/\\/\\//gi, '/').replaceAll(/\\/\\//gi, '/')}`\n        _c.headers.Cookie = `IsvToken=${this.isvToken};${this.ticket}isBasicJson=true;`\n        _c.headers.Referer = this.referer || `${this.activityUrl}&sid=${this.sid}&un_area=${this.un_area}`\n    }\n    this.tickets.set(\"AUTH_CUSER\", this.Pin);\n    for (let key of Object.keys(this.tickets)) {\n        if (this.tickets.get(key)) {\n            headers[key.replace(\"_\", \"\").toLowerCase()] = this.tickets.get(key)\n        }\n    }\n    return {_u, _b};\n}"
    ],
    "rsaEncrypt": [
      "function rsaEncrypt(publicKey, opt, data) {\n    publicKey = `-----BEGIN PUBLIC KEY-----\\n${publicKey}\\n-----END PUBLIC KEY-----`;\n    let key = new NodeRSA(publicKey);\n    key.setOptions(opt);\n    return key.encrypt(data, 'base64');\n}"
    ],
    "saveAddress": [
      "async function saveAddress(addressId = this.addressId, prizeName = this.prizeName, prizeId = this.prizeId, addr = \"\") {\n    this.putMsg(`addressId=${addressId},prizeName=${prizeName},ptpin=${this.ptpin},prizeId=${prizeId}`)\n    if (this.wxAddressStop(prizeName)) {\n        return\n    }\n    if (this.super.currAddressPtpin && this.super.currAddressPtpin !== this.ptpin) {\n        this.super.addressIndex++;\n    }\n    this.super.currAddressPtpin = this.ptpin;\n    let addrInfo = addr || this.selectAddress(this.ptpin);\n    if (!addrInfo) {\n        this.putMsg(\"æ²¡æœ‰æ‰¾åˆ°åœ°å€ä¿¡æ¯\")\n        return\n    }\n    this.log(`å½“å‰åœ°å€è¯¦æƒ… ${JSON.stringify(addrInfo)}`);\n    this.putMsg(addrInfo.address)\n    let isSaveAddr = false;\n    try {\n        let saveData = await this.api('/api/my/prize/update', {\n            \"realName\": addrInfo.receiver,\n            \"mobile\": addrInfo.phone,\n            \"address\": addrInfo.address,\n            \"orderCode\": addressId,\n            \"province\": addrInfo.province,\n            \"city\": addrInfo.city,\n            \"county\": addrInfo.county\n        });\n        this.log(saveData);\n        if (saveData?.data !== \"2\") {\n            isSaveAddr = true\n        } else {\n            this.putMsg(`è¶…ä¸€å°æ—¶æˆ–å…¶ä»–æŠ¥é”™ï¼Œè¯·æ‰‹åŠ¨è¿›æ´»åŠ¨ç¡®è®¤`)\n        }\n    } catch (e) {\n        this.log(e)\n    }\n    if (isSaveAddr) {\n        this.putMsg(`å·²å¡«åœ°å€`)\n        await fs.appendFileSync(\"gifts.csv\", `${this.now()},${prizeName},${this.ptpin},${addrInfo.phone},${addrInfo.address},${this.super.name},${this.super.shopName},${this.activityUrl},${this.cookie}\\n`)\n    }\n    return isSaveAddr;\n}",
      "async function saveAddress(addressId = this.addressId, prizeName = this.prizeName, prizeId = this.prizeId, addr = \"\") {\n    this.putMsg(`addressId=${addressId},prizeName=${prizeName},ptpin=${this.ptpin},prizeId=${prizeId}`)\n    if (this.wxAddressStop(prizeName)) {\n        return\n    }\n    if (this.super.currAddressPtpin && this.super.currAddressPtpin !== this.ptpin) {\n        this.super.addressIndex++;\n    }\n    this.super.currAddressPtpin = this.ptpin;\n    let addrInfo = addr || this.selectAddress(this.ptpin);\n    if (!addrInfo) {\n        this.putMsg(\"æ²¡æœ‰æ‰¾åˆ°åœ°å€ä¿¡æ¯\")\n        return\n    }\n    this.log(`å½“å‰åœ°å€è¯¦æƒ… ${JSON.stringify(addrInfo)}`);\n    this.putMsg(addrInfo.address)\n    let isSaveAddr = false;\n    try {\n        let address = `${addrInfo.province.replace(\"å¸‚\", \"\").replace('çœ', '')} ${addrInfo.city.replace('å¸‚', '')} ${addrInfo.county}${addrInfo.address}`\n        let saveData = await this.api('/ql/front/postBuyerInfo', `receiverName=${encodeURIComponent(addrInfo.receiver)}&mobile=${addrInfo.phone}&address=${encodeURIComponent(address)}&log_id=${addressId}&user_id=${this.super.userId}`)\n        this.log(saveData);\n        if (saveData.succ) {\n\n            isSaveAddr = true\n        } else {\n            this.putMsg(saveData.msg)\n        }\n    } catch (e) {\n        this.log(e)\n    }\n    if (isSaveAddr) {\n        this.putMsg(`å·²å¡«åœ°å€`)\n        await fs.appendFileSync(\"gifts.csv\", `${this.now()},${prizeName},${this.ptpin},${addrInfo.phone},${addrInfo.address},${this.super.name},${this.super.shopName},${this.activityUrl},${this.cookie}\\n`)\n    }\n    return isSaveAddr;\n}",
      "async function saveAddress(addressId = this.addressId, prizeName = this.prizeName, prizeId = this.prizeId, addr = \"\") {\n    this.putMsg(`addressId=${addressId},prizeName=${prizeName},ptpin=${this.ptpin},prizeId=${prizeId}`)\n    if (this.wxAddressStop(prizeName)) {\n        return\n    }\n    if (this.super.currAddressPtpin && this.super.currAddressPtpin !== this.ptpin) {\n        this.super.addressIndex++;\n    }\n    this.super.currAddressPtpin = this.ptpin;\n    let addrInfo = addr || this.selectAddress(this.ptpin);\n    if (!addrInfo) {\n        this.putMsg(\"æ²¡æœ‰æ‰¾åˆ°åœ°å€ä¿¡æ¯\")\n        return\n    }\n    this.log(`å½“å‰åœ°å€è¯¦æƒ… ${JSON.stringify(addrInfo)}`);\n    this.putMsg(addrInfo.address)\n    let isSaveAddr = false;\n    try {\n        let saveData = await this.api('wxAddress/save', `venderId=${this.super.venderId}&pin=${this.Pin}&activityId=${this.activityId}&actType=${this.activityType}&prizeName=${encodeURIComponent(prizeName)}&receiver=${encodeURIComponent(addrInfo.receiver)}&phone=${addrInfo.phone}&province=${encodeURIComponent(addrInfo.province)}&city=${encodeURIComponent(addrInfo.city)}&address=${encodeURIComponent(addrInfo.address)}&generateId=${addressId}&postalCode=${addrInfo.postalCode}&areaCode=${encodeURIComponent(addrInfo.areaCode)}&county=${encodeURIComponent(addrInfo.county)}`);\n        if(!saveData.result) {\n            this.putMsg(saveData.errorMessage)\n            if (saveData.errorMessage.includes(\"æ‚¨å¿…é¡»åœ¨ä¸­å¥–ä¸€å°æ—¶å†…å¡«å†™ä¸­å¥–åœ°å€\")){\n                return;\n            }\n        }\n        if (saveData.result) {\n            isSaveAddr = true\n        } else {\n            this.putMsg(`venderIdå¡«åœ°å€å¤±è´¥`)\n            saveData = await this.api('wxAddress/save', `venderId=${this.super.shopId}&pin=${this.Pin}&activityId=${this.activityId}&actType=${this.activityType}&prizeName=${encodeURIComponent(prizeName)}&receiver=${encodeURIComponent(addrInfo.receiver)}&phone=${addrInfo.phone}&province=${encodeURIComponent(addrInfo.province)}&city=${encodeURIComponent(addrInfo.city)}&address=${encodeURIComponent(addrInfo.address)}&generateId=${addressId}&postalCode=${addrInfo.postalCode}&areaCode=${encodeURIComponent(addrInfo.areaCode)}&county=${encodeURIComponent(addrInfo.county)}`);\n            if (saveData.result) {\n                isSaveAddr = true\n            } else {\n                this.putMsg(`${saveData.errorMessage}`)\n            }\n        }\n    } catch (e) {\n        this.log(e)\n    }\n    if (isSaveAddr) {\n        this.putMsg(`å·²å¡«åœ°å€`)\n        await fs.appendFileSync(\"gifts.csv\", `${this.now()},${prizeName},${this.ptpin},${addrInfo.phone},${addrInfo.address},${this.super.name},${this.super.shopName},${this.activityUrl},${this.cookie}\\n`)\n    }\n    return isSaveAddr;\n}"
    ],
    "taskToDo": [
      "async function taskToDo(taskList = []) {\n    if (!taskList || taskList.length === 0) {\n        return\n    }\n    if (taskList.filter(o => ![8, 15, 13].includes(o.taskType * 1)).length === 0) {\n        this.log(\"æ²¡æœ‰ä»»åŠ¡\")\n    }\n    for (let ele of taskList.filter(o => ![8, 13, 15].includes(o.taskType) && o.status === 0) || []) {\n        for (let ele of taskList.filter(o => o.status === 0) || []) {\n            try { /*\n                    å…³æ³¨åº—é“º    1\n                    æµè§ˆåº—é“º    2\n                    æµè§ˆå•†å“    3\n                    æµè§ˆä¼šåœº/ç›´æ’­    4\n                    å…³æ³¨å•†å“    5\n                    é¢„çº¦å•†å“    6\n                    åŠ è´­ä»»åŠ¡    7\n                    è´­ä¹°å•†å“    8\n                    åˆ†äº«å•†å“    9\n                    åˆ†äº«åº—é“º    10\n                    åˆ†äº«æ´»åŠ¨    12\n                    ä¼šå‘˜å¼€å¡    13\n                    æ¯æ—¥ç­¾åˆ°    14\n                    é‚€è¯·åŠ©åŠ›    15\n                    */\n                if ([1, 2, 4, 10, 12, 14].includes(ele.taskType)) {\n                    await this.api('/api/basic/task/toDo', {'skuId': '', 'taskId': ele.taskId})\n                } else if ([3, 5, 6, 7, 9].includes(ele.taskType)) {\n                    let skuIds = ele.skuInfoVO.filter(o => o.status === 0)\n                    if (ele.hasOwnProperty(\"activeLimit\")) {\n                        for (let i = 0; i < skuIds.length && (i < ele.activeLimit.limitNum * ele.finishNum || i < ele.finishNum || i < ele.maxNum); i++) {\n                            await this.api('/api/basic/task/toDo', {'skuId': skuIds[i].skuId, 'taskId': ele.taskId})\n                        }\n                    } else {\n                        for (let i = 0; i < skuIds.length && (i < ele.finishNum || i < ele.maxNum); i++) {\n                            await this.api('/api/basic/task/toDo', {'skuId': skuIds[i].skuId, 'taskId': ele.taskId})\n                        }\n                    }\n\n                }\n            } catch (e) {\n                this.log(e.message, JSON.stringify(ele))\n            }\n        }\n    }\n}"
    ],
    "v": [
      "function v(e) {\n    let b = [\"B6dB3QqGZP1lKNICTaiAeNJSHKNepO5GGgtL6FUceqSlpFZCdx2SZ5MPPbzrgy91HeR0dnJazcMrvMgPF7bhFrfsGaApJKk4JohEEhoJ4kKJpAaGsfrFhb7FPgMvrMczaJnd0ReH19ygrzbPPM5ZS2xdCZFplSqecUF6LtgGG5OpeNKHSJNeAiaTCINKl1PZGqQ3Bd6B\",\n        \"EUhzJoyKP7VydtpyBwNUGU2tqzI0QB0LIpQ10Fk3hX2ZcPoGRpACqmzcTQbKd98i3U7raFz2rMl2kys0ODgtAh22E3i57wmh38RbbR83hmw75i3E22hAtgDO0syk2lMr2zFar7U3i89dKbQTczmqCApRGoPcZ2Xh3kF01QpIL0BQ0Izqt2UGUNwByptdyV7PKyoJzhUE\",\n        \"xexcHoyVwOs5TYTQVvU0iXn56ryKVdWedLTpq3KEKmbUHfwzuZjIpZOPVXMEappFhjdqwtp1bBrWaRBCfPFwCq2W8SsyvwqZ6sIGGIs6ZqwvysS8W2qCwFPfCBRaWrBb1ptwqdjhFppaEMXVPOZpIjZuzwfHUbmKEK3qpTLdeWdVKyr65nXi0UvVQTYT5sOwVyoHcxex\",\n        \"2Llnegc5i4flqd4HZPFK210yh61boBxRSdnNVMeudKimx92Qi4aPuHP12HmEImbWrXjLgBGqy1bSnKvLhqMqhknyuse4nFoeLTkJJkTLeoFn4esuynkhqMqhLvKnSb1yqGBgLjXrWbmIEmH21PHuPa4iQ29xmiKdueMVNndSRxBob16hy012KFPZH4dqlf4i5cgenlL2\",\n        \"dZzoMZF6xtt3voTFDbPzEZ7GeM8t7uY05d4K4xfhtdxELh96dDRB4oRYA2smET5dy1dafGkXOz2V7tNOVi0vSqfuhI99IKprVK6QQ6KVrpKI99IhufqSv0iVONt7V2zOXkGfad1yd5TEms2AYRo4BRDd69hLExdthfx4K4d50Yu7t8MeG7ZEzPbDFTov3ttx6FZMozZd\",\n        \"SNYr3bWMtQulWZO2FEwuhSFp3EXPR1TujPRJwUFlxBh9Pvf2MeTEpR7a3dU6e9rNUMyBh2osDdK4Vdm4gZ0XcRCoHZPi2jiXT2dCCd2TXij2iPZHoCRcX0Zg4mdV4KdDso2hByMUNr9e6Ud3a7RpETeM2fvP9hBxlFUwJRPjuT1RPXE3pFShuwEF2OZWluQtMWb3rYNS\",\n        \"4viQ2FrYHcrH44gqvPLo6KtiFu56AW1eXbDBZrBepzdLKE33Ey4TwFERnkVLnbHAXbKqAi0HFP9Eu7yg8WNlI7q2dvXGGiPaMbrBBrbMaPiGGXvd2q7IlNW8gy7uE9PFH0iAqKbXAHbnLVknREFwT4yE33EKLdzpeBrZBDbXe1WA65uFitK6oLPvqg44HrcHYrF2Qiv4\",\n        \"0VIoSHBNVAW8De7NquFyEUm0o9xNnQJGn2OR1yOK9djWALhyP3a1XoQEwTnXuzypRuwsaLPUlertksOY6LYmnbQmPgdDQRXXKdKooKdKXXRQDdgPmQbnmYL6YOsktrelUPLaswuRpyzuXnTwEQoX1a3PyhLAWjd9KOy1RO2nGJQnNx9o0mUEyFuqN7eD8WAVNBHSoIV0\",\n        \"fdJPBiTra9E0qg2HJrobeEC2SkOfSzbw6nG5J5ACx42GQDBsCyGfxNlHHYhl7EmkdvYaKAXUVXSKcTT1KhyYaj9Q4YtyhnOA7cLrrLc7AOnhytY4Q9jaYyhK1TTcKSXVUXAKaYvdkmE7lhYHHlNxfGyCsBDQG24xCA5J5Gn6wbzSfOkS2CEeborJH2gq0E9arTiBPJdf\",\n        \"kLOA93PyUOX3QdlLuZ9JgNq1peyIITAQSnKzuLBZ2NthOSseAJMGCecvSLVKAww61Y31hJ4l7kAOcjLmtqQNJlNyJb5yu9d9vqWUUWqv9d9uy5bJyNlJNQqtmLjcOAk7l4Jh13Y16wwAKVLSvceCGMJAesSOhtN2ZBLuzKnSQATIIyep1qNgJ9ZuLldQ3XOUyP39AOLk\"];\n\n    var t = e.nowTime + parseInt(this.tickets.get(\"te\"));\n    let pToken = this.tickets.get(\"pToken\");\n    e.nowTime = t;\n    for (var i = pToken + t, o = i.substring(0, i.length - 5), a = \"\", n = 0; n < o.length; n++) {\n        var s = o.charCodeAt(n);\n        a += b[s % 10][n]\n    }\n    for (var c = a.length, l = Math.floor(c / 24), d = \"\", g = 0; g < 24; g++) {\n        var f = (g + 1) * l;\n        23 === g && (f = c);\n        for (var p = a.substring(g * l, f), u = [], h = 0; h < p.length; h++) {\n            u.push(p.charCodeAt(h));\n        }\n        var v = u.reduce(function (e, t) {\n            return e + t\n        }, 0), y = Math.floor(v / u.length);\n        d += String.fromCharCode(y)\n    }\n    var k = function (e) {\n        e = e.split(\"\").reverse().join(\"\");\n        for (var t = new Uint8Array(12), i = (new TextEncoder).encode(e), o = 0; o < i.length; o += 2) {\n            var a = i[o] << 5 | 255 & i[o + 1];\n            a %= 63, t[o >> 1] = a\n        }\n        for (var n = \"\", r = 0; r < t.length; r++) {\n            n += (t[r] + 256).toString(2).slice(1);\n        }\n        for (var s = \"\", m = \"\", c = 0; c < 16; c++) {\n            if (0 !== c) {\n                for (var l = 6 * c, d = n.substring(l, l + 6), g = parseInt(d, 2), f = m.split(\"\"), p = 0; p < f.length; p++) {\n                    \"1\" === f[p] && (g = 63 & (g >> 6 - p | g << p));\n                }\n                m = (63 & g).toString(2).padStart(6, \"0\")\n            } else {\n                m = n.substring(0, 6);\n            }\n            s += m\n        }\n        for (var u = 0; u < 12; u++) {\n            var b = 8 * u;\n            t[u] = parseInt(s.substring(b, b + 8), 2)\n        }\n        return base64.encode(String.fromCharCode.apply(null, t))\n    }(a = d), w = CryptoJS.enc.Utf8.parse(k), B = CryptoJS.enc.Utf8.parse(\"\");\n    return CryptoJS.AES.encrypt(JSON.stringify(e), w, {\n        iv: B,\n        mode: CryptoJS.mode.ECB,\n        padding: CryptoJS.pad.Pkcs7\n    }).toString()\n}"
    ],
    "getSimpleActInfoVo": [
      "async function getSimpleActInfoVo(fn = 'customer/getSimpleActInfoVo', body = \"\") {\n    if (this.super.venderId && this.super.shopId && this.super.activityType) {\n        await this.initPinToken()\n        return\n    }\n    let actInfo = await this.api(fn, body || `activityId=${this.activityId}`);\n    if (!actInfo.result || !actInfo.data) {\n        //å°è¯•è§£å†³å·²ç»“æŸæ´»åŠ¨\n        await this.api(this.activityUrl)\n        this.putMsg('æ‰‹åŠ¨ç¡®è®¤');\n        this.super.handConfirm++;\n        if (this.super.handConfirm > 3) {\n            this.super.exit = true;\n        }\n        throw new CustomError(\"æ‰‹åŠ¨ç¡®è®¤\")\n    }\n    this.super.venderId = actInfo.data.venderId || this.venderId;\n    this.super.shopId = actInfo.data.shopId || this.shopId;\n    this.super.activityType = actInfo.data.activityType || this.activityType;\n    await this.initPinToken()\n}",
      "async function getSimpleActInfoVo(fn = 'customer/getSimpleActInfoVo', body = \"\") {\n    let actInfo = await this.api(fn, body || `activityId=${this.activityId}`);\n    if (!actInfo.result || !actInfo.data) {\n        //å°è¯•è§£å†³å·²ç»“æŸæ´»åŠ¨\n        await this.api(this.activityUrl)\n        this.putMsg('æ‰‹åŠ¨ç¡®è®¤');\n        this.super.handConfirm++;\n        if (this.super.handConfirm > 3) {\n            this.super.exit = true;\n        }\n        throw new CustomError(\"æ‰‹åŠ¨ç¡®è®¤\")\n    }\n    this.super.venderId = actInfo.data.venderId || this.venderId;\n    this.super.shopId = actInfo.data.shopId || this.shopId;\n    this.super.activityType = actInfo.data.activityType || this.activityType;\n}"
    ]
  }